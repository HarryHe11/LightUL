Read ml-1M dataset done! u_num: 6040, i_num: 3883
Load a pre-trained model
UL AUC before unlearning: 0.4898
ACC AUC before unlearning: 0.9108
NDCG@20 before unlearning: 0.2855
[RETRAIN] START TRAINING. CURRENT TIME: 0.01min.
Epoch [1/2000], Loss: 0.4118, UL AUC: 0.5169, ACC AUC: 0.8463, ACC NDCG@20: 0.1734, Time: 19.17s
Epoch [2/2000], Loss: 0.3151, UL AUC: 0.5224, ACC AUC: 0.8689, ACC NDCG@20: 0.1934, Time: 18.15s
Epoch [3/2000], Loss: 0.2727, UL AUC: 0.5300, ACC AUC: 0.8819, ACC NDCG@20: 0.2161, Time: 18.28s
Epoch [4/2000], Loss: 0.2464, UL AUC: 0.5374, ACC AUC: 0.8903, ACC NDCG@20: 0.2323, Time: 18.23s
Epoch [5/2000], Loss: 0.2291, UL AUC: 0.5420, ACC AUC: 0.8957, ACC NDCG@20: 0.2427, Time: 18.10s
Epoch [6/2000], Loss: 0.2167, UL AUC: 0.5456, ACC AUC: 0.8993, ACC NDCG@20: 0.2555, Time: 18.53s
Epoch [7/2000], Loss: 0.2062, UL AUC: 0.5490, ACC AUC: 0.9016, ACC NDCG@20: 0.2607, Time: 18.20s
Epoch [8/2000], Loss: 0.1983, UL AUC: 0.5524, ACC AUC: 0.9036, ACC NDCG@20: 0.2670, Time: 18.24s
Epoch [9/2000], Loss: 0.1919, UL AUC: 0.5579, ACC AUC: 0.9048, ACC NDCG@20: 0.2700, Time: 18.11s
Epoch [10/2000], Loss: 0.1868, UL AUC: 0.5604, ACC AUC: 0.9061, ACC NDCG@20: 0.2707, Time: 18.22s
Epoch [11/2000], Loss: 0.1812, UL AUC: 0.5620, ACC AUC: 0.9069, ACC NDCG@20: 0.2734, Time: 18.34s
Epoch [12/2000], Loss: 0.1776, UL AUC: 0.5647, ACC AUC: 0.9075, ACC NDCG@20: 0.2796, Time: 18.20s
Epoch [13/2000], Loss: 0.1737, UL AUC: 0.5700, ACC AUC: 0.9080, ACC NDCG@20: 0.2775, Time: 18.04s
Epoch [14/2000], Loss: 0.1715, UL AUC: 0.5733, ACC AUC: 0.9087, ACC NDCG@20: 0.2811, Time: 17.85s
Epoch [15/2000], Loss: 0.1671, UL AUC: 0.5771, ACC AUC: 0.9089, ACC NDCG@20: 0.2807, Time: 18.26s
Epoch [16/2000], Loss: 0.1646, UL AUC: 0.5800, ACC AUC: 0.9092, ACC NDCG@20: 0.2804, Time: 17.98s
Epoch [17/2000], Loss: 0.1618, UL AUC: 0.5821, ACC AUC: 0.9093, ACC NDCG@20: 0.2828, Time: 17.93s
Epoch [18/2000], Loss: 0.1605, UL AUC: 0.5855, ACC AUC: 0.9097, ACC NDCG@20: 0.2836, Time: 18.17s
Epoch [19/2000], Loss: 0.1578, UL AUC: 0.5883, ACC AUC: 0.9099, ACC NDCG@20: 0.2811, Time: 18.27s
Epoch [20/2000], Loss: 0.1562, UL AUC: 0.5877, ACC AUC: 0.9098, ACC NDCG@20: 0.2816, Time: 18.02s
Epoch [21/2000], Loss: 0.1546, UL AUC: 0.5896, ACC AUC: 0.9102, ACC NDCG@20: 0.2812, Time: 18.05s
Epoch [22/2000], Loss: 0.1534, UL AUC: 0.5945, ACC AUC: 0.9101, ACC NDCG@20: 0.2793, Time: 18.01s
Epoch [23/2000], Loss: 0.1510, UL AUC: 0.5970, ACC AUC: 0.9102, ACC NDCG@20: 0.2827, Time: 17.90s
Epoch [24/2000], Loss: 0.1497, UL AUC: 0.5984, ACC AUC: 0.9105, ACC NDCG@20: 0.2833, Time: 17.89s
Epoch [25/2000], Loss: 0.1502, UL AUC: 0.6022, ACC AUC: 0.9104, ACC NDCG@20: 0.2805, Time: 17.97s
Epoch [26/2000], Loss: 0.1480, UL AUC: 0.6032, ACC AUC: 0.9103, ACC NDCG@20: 0.2787, Time: 17.74s
Epoch [27/2000], Loss: 0.1480, UL AUC: 0.6059, ACC AUC: 0.9105, ACC NDCG@20: 0.2785, Time: 18.02s
Epoch [28/2000], Loss: 0.1468, UL AUC: 0.6072, ACC AUC: 0.9102, ACC NDCG@20: 0.2758, Time: 17.94s
Epoch [29/2000], Loss: 0.1456, UL AUC: 0.6102, ACC AUC: 0.9104, ACC NDCG@20: 0.2762, Time: 17.99s
Epoch [30/2000], Loss: 0.1439, UL AUC: 0.6111, ACC AUC: 0.9107, ACC NDCG@20: 0.2813, Time: 17.88s
Epoch [31/2000], Loss: 0.1428, UL AUC: 0.6155, ACC AUC: 0.9106, ACC NDCG@20: 0.2779, Time: 17.93s
Epoch [32/2000], Loss: 0.1433, UL AUC: 0.6164, ACC AUC: 0.9106, ACC NDCG@20: 0.2742, Time: 17.36s
Epoch [33/2000], Loss: 0.1414, UL AUC: 0.6153, ACC AUC: 0.9106, ACC NDCG@20: 0.2807, Time: 17.95s
Epoch [34/2000], Loss: 0.1414, UL AUC: 0.6152, ACC AUC: 0.9106, ACC NDCG@20: 0.2774, Time: 17.99s
Epoch [35/2000], Loss: 0.1410, UL AUC: 0.6145, ACC AUC: 0.9106, ACC NDCG@20: 0.2818, Time: 17.81s
Epoch [36/2000], Loss: 0.1403, UL AUC: 0.6180, ACC AUC: 0.9103, ACC NDCG@20: 0.2752, Time: 18.05s
Epoch [37/2000], Loss: 0.1399, UL AUC: 0.6179, ACC AUC: 0.9105, ACC NDCG@20: 0.2798, Time: 17.86s
Epoch [38/2000], Loss: 0.1390, UL AUC: 0.6195, ACC AUC: 0.9104, ACC NDCG@20: 0.2773, Time: 17.90s
Epoch [39/2000], Loss: 0.1393, UL AUC: 0.6228, ACC AUC: 0.9104, ACC NDCG@20: 0.2754, Time: 18.02s
Epoch [40/2000], Loss: 0.1373, UL AUC: 0.6230, ACC AUC: 0.9104, ACC NDCG@20: 0.2774, Time: 18.01s
Epoch [41/2000], Loss: 0.1372, UL AUC: 0.6224, ACC AUC: 0.9106, ACC NDCG@20: 0.2763, Time: 17.96s
Epoch [42/2000], Loss: 0.1371, UL AUC: 0.6256, ACC AUC: 0.9102, ACC NDCG@20: 0.2739, Time: 17.70s
Epoch [43/2000], Loss: 0.1367, UL AUC: 0.6232, ACC AUC: 0.9103, ACC NDCG@20: 0.2772, Time: 17.86s
Epoch [44/2000], Loss: 0.1372, UL AUC: 0.6249, ACC AUC: 0.9104, ACC NDCG@20: 0.2757, Time: 18.05s
Epoch [45/2000], Loss: 0.1359, UL AUC: 0.6243, ACC AUC: 0.9104, ACC NDCG@20: 0.2790, Time: 18.32s
Epoch [46/2000], Loss: 0.1355, UL AUC: 0.6246, ACC AUC: 0.9102, ACC NDCG@20: 0.2769, Time: 17.92s
Epoch [47/2000], Loss: 0.1352, UL AUC: 0.6245, ACC AUC: 0.9107, ACC NDCG@20: 0.2817, Time: 17.97s
Epoch [48/2000], Loss: 0.1361, UL AUC: 0.6273, ACC AUC: 0.9101, ACC NDCG@20: 0.2731, Time: 17.87s
Epoch [49/2000], Loss: 0.1349, UL AUC: 0.6270, ACC AUC: 0.9103, ACC NDCG@20: 0.2750, Time: 18.01s
Epoch [50/2000], Loss: 0.1351, UL AUC: 0.6300, ACC AUC: 0.9099, ACC NDCG@20: 0.2729, Time: 17.58s
Epoch [51/2000], Loss: 0.1335, UL AUC: 0.6290, ACC AUC: 0.9101, ACC NDCG@20: 0.2800, Time: 17.78s
Epoch [52/2000], Loss: 0.1346, UL AUC: 0.6280, ACC AUC: 0.9100, ACC NDCG@20: 0.2773, Time: 18.02s
Epoch [53/2000], Loss: 0.1346, UL AUC: 0.6272, ACC AUC: 0.9100, ACC NDCG@20: 0.2784, Time: 17.49s
Epoch [54/2000], Loss: 0.1333, UL AUC: 0.6302, ACC AUC: 0.9099, ACC NDCG@20: 0.2765, Time: 18.27s
Epoch [55/2000], Loss: 0.1337, UL AUC: 0.6284, ACC AUC: 0.9099, ACC NDCG@20: 0.2752, Time: 17.98s
Epoch [56/2000], Loss: 0.1328, UL AUC: 0.6283, ACC AUC: 0.9097, ACC NDCG@20: 0.2732, Time: 17.91s
Epoch [57/2000], Loss: 0.1333, UL AUC: 0.6272, ACC AUC: 0.9100, ACC NDCG@20: 0.2769, Time: 18.08s
Epoch [58/2000], Loss: 0.1317, UL AUC: 0.6280, ACC AUC: 0.9101, ACC NDCG@20: 0.2775, Time: 17.85s
Epoch [59/2000], Loss: 0.1331, UL AUC: 0.6317, ACC AUC: 0.9101, ACC NDCG@20: 0.2735, Time: 18.27s
Epoch [60/2000], Loss: 0.1328, UL AUC: 0.6304, ACC AUC: 0.9100, ACC NDCG@20: 0.2755, Time: 18.26s
Epoch [61/2000], Loss: 0.1328, UL AUC: 0.6316, ACC AUC: 0.9100, ACC NDCG@20: 0.2759, Time: 17.95s
Epoch [62/2000], Loss: 0.1319, UL AUC: 0.6313, ACC AUC: 0.9102, ACC NDCG@20: 0.2781, Time: 17.89s
Epoch [63/2000], Loss: 0.1314, UL AUC: 0.6299, ACC AUC: 0.9101, ACC NDCG@20: 0.2764, Time: 17.38s
Epoch [64/2000], Loss: 0.1308, UL AUC: 0.6337, ACC AUC: 0.9099, ACC NDCG@20: 0.2752, Time: 18.10s
Epoch [65/2000], Loss: 0.1316, UL AUC: 0.6331, ACC AUC: 0.9098, ACC NDCG@20: 0.2762, Time: 18.26s
Epoch [66/2000], Loss: 0.1313, UL AUC: 0.6307, ACC AUC: 0.9102, ACC NDCG@20: 0.2767, Time: 17.68s
Epoch [67/2000], Loss: 0.1294, UL AUC: 0.6326, ACC AUC: 0.9098, ACC NDCG@20: 0.2741, Time: 18.46s
Epoch [68/2000], Loss: 0.1306, UL AUC: 0.6318, ACC AUC: 0.9098, ACC NDCG@20: 0.2796, Time: 18.14s
Epoch [69/2000], Loss: 0.1305, UL AUC: 0.6340, ACC AUC: 0.9097, ACC NDCG@20: 0.2758, Time: 17.99s
Epoch [70/2000], Loss: 0.1311, UL AUC: 0.6331, ACC AUC: 0.9096, ACC NDCG@20: 0.2765, Time: 18.01s
Epoch [71/2000], Loss: 0.1300, UL AUC: 0.6345, ACC AUC: 0.9097, ACC NDCG@20: 0.2800, Time: 18.15s
Epoch [72/2000], Loss: 0.1301, UL AUC: 0.6348, ACC AUC: 0.9096, ACC NDCG@20: 0.2752, Time: 17.84s
Epoch [73/2000], Loss: 0.1298, UL AUC: 0.6347, ACC AUC: 0.9099, ACC NDCG@20: 0.2784, Time: 17.87s
Epoch [74/2000], Loss: 0.1296, UL AUC: 0.6348, ACC AUC: 0.9096, ACC NDCG@20: 0.2772, Time: 17.68s
Epoch [75/2000], Loss: 0.1297, UL AUC: 0.6322, ACC AUC: 0.9098, ACC NDCG@20: 0.2786, Time: 17.99s
Epoch [76/2000], Loss: 0.1297, UL AUC: 0.6336, ACC AUC: 0.9098, ACC NDCG@20: 0.2775, Time: 18.06s
Epoch [77/2000], Loss: 0.1299, UL AUC: 0.6352, ACC AUC: 0.9096, ACC NDCG@20: 0.2744, Time: 18.17s
Epoch [78/2000], Loss: 0.1295, UL AUC: 0.6353, ACC AUC: 0.9097, ACC NDCG@20: 0.2766, Time: 18.20s
Best NDCG@20: 0.2836, Best epoch: 17, total time: 1423.970s
[RETRAIN] TRAINING FINISHED. TOTAL TIME: 23.75min.
Precision@20: 0.2568; Recall@20: 0.1712;  NDCG@20: 0.2855;  
Precision@50: 0.1868; Recall@50: 0.3114;  NDCG@50: 0.3099;  
Precision@100: 0.1369; Recall@100: 0.4566;  NDCG@100: 0.3869;  
Before unlearning: ACC AUC: 0.9108, UL AUC: 0.4898, ACC NDCG@20: 0.2855
After unlearning: ACC AUC: 0.9097, UL AUC: 0.5855, ACC NDCG@20: 0.2855
