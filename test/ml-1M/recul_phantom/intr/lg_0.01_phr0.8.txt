Read ml-1M dataset done! u_num: 6040, i_num: 3883
Load a pre-trained model
UL AUC before unlearning: 0.4898
ACC AUC before unlearning: 0.9108
NDCG@20 before unlearning: 0.2855
Start phantom user assignment k-means!
Finish phantom user assignment k-means!
AUC before unlearning: 0.5787
NDCG@20 before unlearning: 0.2828
[RECUL] START TRAINING. CURRENT TIME: 0.22min.
[RECUL] PREPROCESS FINISHED. CURRENT TIME: 0.02min.
[RecUL] Epoch [1/2000], Loss: 2.2742, UL AUC: 0.4441, ACC AUC: 0.6898, ACC NDCG@20: 0.2864, Current time: 0.28min
[RecUL] Epoch [2/2000], Loss: 2.0299, UL AUC: 0.4470, ACC AUC: 0.7275, ACC NDCG@20: 0.2900, Current time: 0.53min
[RecUL] Epoch [3/2000], Loss: 1.9600, UL AUC: 0.4353, ACC AUC: 0.7541, ACC NDCG@20: 0.2910, Current time: 0.73min
[RecUL] Epoch [4/2000], Loss: 1.9244, UL AUC: 0.4495, ACC AUC: 0.7748, ACC NDCG@20: 0.2918, Current time: 0.98min
[RecUL] Epoch [5/2000], Loss: 1.8332, UL AUC: 0.4701, ACC AUC: 0.7783, ACC NDCG@20: 0.2929, Current time: 1.04min
[RecUL] Epoch [6/2000], Loss: 1.8191, UL AUC: 0.4818, ACC AUC: 0.7874, ACC NDCG@20: 0.2925, Current time: 1.30min
[RecUL] Epoch [7/2000], Loss: 1.8178, UL AUC: 0.4814, ACC AUC: 0.7973, ACC NDCG@20: 0.2925, Current time: 1.55min
[RecUL] Epoch [8/2000], Loss: 1.7499, UL AUC: 0.4953, ACC AUC: 0.8020, ACC NDCG@20: 0.2931, Current time: 1.80min
[RecUL] Epoch [9/2000], Loss: 1.7705, UL AUC: 0.5025, ACC AUC: 0.8102, ACC NDCG@20: 0.2922, Current time: 2.05min
[RecUL] Epoch [10/2000], Loss: 1.7550, UL AUC: 0.5106, ACC AUC: 0.8188, ACC NDCG@20: 0.2911, Current time: 2.30min
[RecUL] Epoch [11/2000], Loss: 1.6874, UL AUC: 0.4921, ACC AUC: 0.8238, ACC NDCG@20: 0.2897, Current time: 2.44min
[RecUL] Epoch [12/2000], Loss: 1.6849, UL AUC: 0.5019, ACC AUC: 0.8262, ACC NDCG@20: 0.2894, Current time: 2.70min
[RecUL] Epoch [13/2000], Loss: 1.6657, UL AUC: 0.5037, ACC AUC: 0.8355, ACC NDCG@20: 0.2892, Current time: 2.94min
[RecUL] Epoch [14/2000], Loss: 1.6198, UL AUC: 0.5227, ACC AUC: 0.8415, ACC NDCG@20: 0.2896, Current time: 3.20min
[RecUL] Epoch [15/2000], Loss: 1.5846, UL AUC: 0.5158, ACC AUC: 0.8483, ACC NDCG@20: 0.2902, Current time: 3.37min
[RecUL] Epoch [16/2000], Loss: 1.6238, UL AUC: 0.5050, ACC AUC: 0.8542, ACC NDCG@20: 0.2910, Current time: 3.62min
[RecUL] Epoch [17/2000], Loss: 1.6313, UL AUC: 0.5181, ACC AUC: 0.8523, ACC NDCG@20: 0.2910, Current time: 3.69min
[RecUL] Epoch [18/2000], Loss: 1.5819, UL AUC: 0.5342, ACC AUC: 0.8525, ACC NDCG@20: 0.2917, Current time: 3.94min
[RecUL] Epoch [19/2000], Loss: 1.6020, UL AUC: 0.5520, ACC AUC: 0.8472, ACC NDCG@20: 0.2920, Current time: 4.19min
[RecUL] Epoch [20/2000], Loss: 1.5358, UL AUC: 0.5723, ACC AUC: 0.8513, ACC NDCG@20: 0.2922, Current time: 4.43min
[RecUL] Epoch [21/2000], Loss: 1.5705, UL AUC: 0.5660, ACC AUC: 0.8560, ACC NDCG@20: 0.2913, Current time: 4.68min
[RecUL] Epoch [22/2000], Loss: 1.5290, UL AUC: 0.5661, ACC AUC: 0.8584, ACC NDCG@20: 0.2892, Current time: 4.74min
[RecUL] Epoch [23/2000], Loss: 1.4996, UL AUC: 0.5631, ACC AUC: 0.8620, ACC NDCG@20: 0.2868, Current time: 4.93min
[RecUL] Epoch [24/2000], Loss: 1.5027, UL AUC: 0.6020, ACC AUC: 0.8554, ACC NDCG@20: 0.2856, Current time: 5.18min
[RecUL] Epoch [25/2000], Loss: 1.4882, UL AUC: 0.6042, ACC AUC: 0.8584, ACC NDCG@20: 0.2853, Current time: 5.42min
[RecUL] Epoch [26/2000], Loss: 1.4888, UL AUC: 0.5753, ACC AUC: 0.8643, ACC NDCG@20: 0.2857, Current time: 5.67min
[RecUL] Epoch [27/2000], Loss: 1.4927, UL AUC: 0.5859, ACC AUC: 0.8653, ACC NDCG@20: 0.2862, Current time: 5.92min
[RecUL] Epoch [28/2000], Loss: 1.4836, UL AUC: 0.5743, ACC AUC: 0.8673, ACC NDCG@20: 0.2867, Current time: 6.17min
[RecUL] Epoch [29/2000], Loss: 1.4558, UL AUC: 0.5799, ACC AUC: 0.8688, ACC NDCG@20: 0.2877, Current time: 6.30min
[RecUL] Epoch [30/2000], Loss: 1.4619, UL AUC: 0.6052, ACC AUC: 0.8641, ACC NDCG@20: 0.2885, Current time: 6.54min
[RecUL] Epoch [31/2000], Loss: 1.4039, UL AUC: 0.6069, ACC AUC: 0.8629, ACC NDCG@20: 0.2890, Current time: 6.77min
[RecUL] Epoch [32/2000], Loss: 1.4390, UL AUC: 0.6193, ACC AUC: 0.8652, ACC NDCG@20: 0.2878, Current time: 6.93min
[RecUL] Epoch [33/2000], Loss: 1.4197, UL AUC: 0.6046, ACC AUC: 0.8662, ACC NDCG@20: 0.2867, Current time: 7.18min
[RecUL] Epoch [34/2000], Loss: 1.3910, UL AUC: 0.6091, ACC AUC: 0.8654, ACC NDCG@20: 0.2867, Current time: 7.44min
[RecUL] Epoch [35/2000], Loss: 1.4010, UL AUC: 0.6156, ACC AUC: 0.8663, ACC NDCG@20: 0.2865, Current time: 7.69min
[RecUL] Epoch [36/2000], Loss: 1.3877, UL AUC: 0.6184, ACC AUC: 0.8708, ACC NDCG@20: 0.2876, Current time: 7.91min
[RecUL] Epoch [37/2000], Loss: 1.3932, UL AUC: 0.6257, ACC AUC: 0.8678, ACC NDCG@20: 0.2880, Current time: 8.16min
[RecUL] Epoch [38/2000], Loss: 1.3878, UL AUC: 0.6278, ACC AUC: 0.8659, ACC NDCG@20: 0.2867, Current time: 8.32min
[RecUL] Epoch [39/2000], Loss: 1.3881, UL AUC: 0.6139, ACC AUC: 0.8685, ACC NDCG@20: 0.2854, Current time: 8.57min
[RecUL] Epoch [40/2000], Loss: 1.3425, UL AUC: 0.6094, ACC AUC: 0.8691, ACC NDCG@20: 0.2843, Current time: 8.82min
[RecUL] Epoch [41/2000], Loss: 1.3526, UL AUC: 0.6403, ACC AUC: 0.8687, ACC NDCG@20: 0.2836, Current time: 8.98min
[RecUL] Epoch [42/2000], Loss: 1.3123, UL AUC: 0.6323, ACC AUC: 0.8716, ACC NDCG@20: 0.2837, Current time: 9.23min
[RecUL] Epoch [43/2000], Loss: 1.3554, UL AUC: 0.6274, ACC AUC: 0.8681, ACC NDCG@20: 0.2836, Current time: 9.31min
[RecUL] Epoch [44/2000], Loss: 1.3655, UL AUC: 0.6335, ACC AUC: 0.8656, ACC NDCG@20: 0.2834, Current time: 9.56min
[RecUL] Epoch [45/2000], Loss: 1.3275, UL AUC: 0.6420, ACC AUC: 0.8631, ACC NDCG@20: 0.2828, Current time: 9.80min
[RecUL] Epoch [46/2000], Loss: 1.3420, UL AUC: 0.6384, ACC AUC: 0.8647, ACC NDCG@20: 0.2827, Current time: 10.05min
[RecUL] Epoch [47/2000], Loss: 1.2874, UL AUC: 0.6383, ACC AUC: 0.8677, ACC NDCG@20: 0.2832, Current time: 10.30min
[RecUL] Epoch [48/2000], Loss: 1.3237, UL AUC: 0.6288, ACC AUC: 0.8684, ACC NDCG@20: 0.2835, Current time: 10.47min
[RecUL] Epoch [49/2000], Loss: 1.2914, UL AUC: 0.6475, ACC AUC: 0.8672, ACC NDCG@20: 0.2832, Current time: 10.71min
[RecUL] Epoch [50/2000], Loss: 1.3076, UL AUC: 0.6359, ACC AUC: 0.8719, ACC NDCG@20: 0.2831, Current time: 10.96min
[RecUL] Epoch [51/2000], Loss: 1.2968, UL AUC: 0.6391, ACC AUC: 0.8719, ACC NDCG@20: 0.2827, Current time: 11.11min
[RecUL] Epoch [52/2000], Loss: 1.2707, UL AUC: 0.6703, ACC AUC: 0.8644, ACC NDCG@20: 0.2821, Current time: 11.37min
[RecUL] Epoch [53/2000], Loss: 1.2680, UL AUC: 0.6888, ACC AUC: 0.8647, ACC NDCG@20: 0.2817, Current time: 11.48min
[RecUL] Epoch [54/2000], Loss: 1.2562, UL AUC: 0.6676, ACC AUC: 0.8634, ACC NDCG@20: 0.2813, Current time: 11.72min
[RecUL] Epoch [55/2000], Loss: 1.2845, UL AUC: 0.6650, ACC AUC: 0.8684, ACC NDCG@20: 0.2808, Current time: 11.97min
[RecUL] Epoch [56/2000], Loss: 1.2549, UL AUC: 0.6561, ACC AUC: 0.8669, ACC NDCG@20: 0.2807, Current time: 12.00min
[RecUL] Epoch [57/2000], Loss: 1.2656, UL AUC: 0.6412, ACC AUC: 0.8674, ACC NDCG@20: 0.2802, Current time: 12.18min
[RecUL] Epoch [58/2000], Loss: 1.2518, UL AUC: 0.6414, ACC AUC: 0.8682, ACC NDCG@20: 0.2790, Current time: 12.43min
[RecUL] Epoch [59/2000], Loss: 1.2346, UL AUC: 0.6653, ACC AUC: 0.8652, ACC NDCG@20: 0.2791, Current time: 12.68min
[RecUL] Epoch [60/2000], Loss: 1.2127, UL AUC: 0.6785, ACC AUC: 0.8664, ACC NDCG@20: 0.2797, Current time: 12.94min
[RecUL] Epoch [61/2000], Loss: 1.2280, UL AUC: 0.6764, ACC AUC: 0.8692, ACC NDCG@20: 0.2807, Current time: 13.18min
[RecUL] Epoch [62/2000], Loss: 1.2638, UL AUC: 0.7097, ACC AUC: 0.8638, ACC NDCG@20: 0.2804, Current time: 13.43min
[RecUL] Epoch [63/2000], Loss: 1.1846, UL AUC: 0.6774, ACC AUC: 0.8692, ACC NDCG@20: 0.2802, Current time: 13.69min
[RecUL] Epoch [64/2000], Loss: 1.1916, UL AUC: 0.6808, ACC AUC: 0.8704, ACC NDCG@20: 0.2796, Current time: 13.94min
[RecUL] Epoch [65/2000], Loss: 1.1966, UL AUC: 0.7043, ACC AUC: 0.8650, ACC NDCG@20: 0.2788, Current time: 14.18min
[RecUL] Epoch [66/2000], Loss: 1.1847, UL AUC: 0.6963, ACC AUC: 0.8679, ACC NDCG@20: 0.2784, Current time: 14.44min
[RecUL] Epoch [67/2000], Loss: 1.2213, UL AUC: 0.6701, ACC AUC: 0.8722, ACC NDCG@20: 0.2781, Current time: 14.49min
[RecUL] Epoch [68/2000], Loss: 1.1450, UL AUC: 0.7060, ACC AUC: 0.8669, ACC NDCG@20: 0.2784, Current time: 14.74min
[RecUL] Epoch [69/2000], Loss: 1.1437, UL AUC: 0.6844, ACC AUC: 0.8725, ACC NDCG@20: 0.2782, Current time: 14.99min
[RecUL] Epoch [70/2000], Loss: 1.2042, UL AUC: 0.6858, ACC AUC: 0.8725, ACC NDCG@20: 0.2779, Current time: 15.23min
[RecUL] Epoch [71/2000], Loss: 1.1813, UL AUC: 0.6864, ACC AUC: 0.8715, ACC NDCG@20: 0.2779, Current time: 15.48min
[RecUL] Epoch [72/2000], Loss: 1.1492, UL AUC: 0.6920, ACC AUC: 0.8713, ACC NDCG@20: 0.2784, Current time: 15.73min
Best UL AUC: 0.7097, Best epoch: 61, total time: 15.96min
[RECUL] TRAINING FINISHED. TOTAL TIME: 16.19min.
Precision@20: 0.2625; Recall@20: 0.1750;  NDCG@20: 0.2863;  
Precision@50: 0.1937; Recall@50: 0.3229;  NDCG@50: 0.3156;  
Precision@100: 0.1411; Recall@100: 0.4703;  NDCG@100: 0.3937;  
Before unlearning: ACC AUC: 0.9108, UL AUC: 0.4898, ACC NDCG@20: 0.2855
After unlearning: ACC AUC: 0.8638, UL AUC: 0.7097, ACC NDCG@20: 0.2863
