Read ml-1M dataset done! u_num: 6040, i_num: 3883
Load a pre-trained model
 UL AUC before unlearning: 0.5083
ACC AUC before unlearning: 0.8614
NDCG@20 before unlearning: 0.2260
Start phantom user assignment k-means!
Finish phantom user assignment k-means!
[RECUL] START TRAINING. CURRENT TIME: 0.18min.
[RECUL] PREPROCESS FINISHED. CURRENT TIME: 0.02min.
[RecUL] Epoch [1/2000], Loss: 3.9052, UL AUC: 0.5244, ACC AUC: 0.8134, ACC NDCG@20: 0.2251, Current time: 0.16min
[RecUL] Epoch [2/2000], Loss: 3.8468, UL AUC: 0.5108, ACC AUC: 0.8169, ACC NDCG@20: 0.2254, Current time: 0.28min
[RecUL] Epoch [3/2000], Loss: 3.8227, UL AUC: 0.5308, ACC AUC: 0.8133, ACC NDCG@20: 0.2254, Current time: 0.40min
[RecUL] Epoch [4/2000], Loss: 3.7892, UL AUC: 0.5560, ACC AUC: 0.8190, ACC NDCG@20: 0.2254, Current time: 0.45min
[RecUL] Epoch [5/2000], Loss: 3.7540, UL AUC: 0.5598, ACC AUC: 0.8177, ACC NDCG@20: 0.2246, Current time: 0.59min
[RecUL] Epoch [6/2000], Loss: 3.7482, UL AUC: 0.5785, ACC AUC: 0.8231, ACC NDCG@20: 0.2245, Current time: 0.73min
[RecUL] Epoch [7/2000], Loss: 3.7229, UL AUC: 0.6041, ACC AUC: 0.8197, ACC NDCG@20: 0.2240, Current time: 0.86min
[RecUL] Epoch [8/2000], Loss: 3.6953, UL AUC: 0.6396, ACC AUC: 0.8128, ACC NDCG@20: 0.2242, Current time: 0.93min
[RecUL] Epoch [9/2000], Loss: 3.6809, UL AUC: 0.6404, ACC AUC: 0.8136, ACC NDCG@20: 0.2238, Current time: 1.07min
[RecUL] Epoch [10/2000], Loss: 3.6517, UL AUC: 0.6435, ACC AUC: 0.8140, ACC NDCG@20: 0.2242, Current time: 1.19min
[RecUL] Epoch [11/2000], Loss: 3.6259, UL AUC: 0.6438, ACC AUC: 0.8114, ACC NDCG@20: 0.2245, Current time: 1.32min
[RecUL] Epoch [12/2000], Loss: 3.6153, UL AUC: 0.6489, ACC AUC: 0.8144, ACC NDCG@20: 0.2241, Current time: 1.34min
[RecUL] Epoch [13/2000], Loss: 3.5925, UL AUC: 0.6680, ACC AUC: 0.8067, ACC NDCG@20: 0.2237, Current time: 1.36min
[RecUL] Epoch [14/2000], Loss: 3.5691, UL AUC: 0.6796, ACC AUC: 0.8046, ACC NDCG@20: 0.2238, Current time: 1.50min
[RecUL] Epoch [15/2000], Loss: 3.5700, UL AUC: 0.6814, ACC AUC: 0.8059, ACC NDCG@20: 0.2235, Current time: 1.64min
[RecUL] Epoch [16/2000], Loss: 3.5608, UL AUC: 0.6844, ACC AUC: 0.8059, ACC NDCG@20: 0.2235, Current time: 1.78min
[RecUL] Epoch [17/2000], Loss: 3.5500, UL AUC: 0.6951, ACC AUC: 0.8026, ACC NDCG@20: 0.2236, Current time: 1.90min
[RecUL] Epoch [18/2000], Loss: 3.5231, UL AUC: 0.7085, ACC AUC: 0.7978, ACC NDCG@20: 0.2231, Current time: 2.02min
[RecUL] Epoch [19/2000], Loss: 3.4896, UL AUC: 0.7097, ACC AUC: 0.7995, ACC NDCG@20: 0.2230, Current time: 2.14min
[RecUL] Epoch [20/2000], Loss: 3.4614, UL AUC: 0.7144, ACC AUC: 0.7980, ACC NDCG@20: 0.2228, Current time: 2.27min
[RecUL] Epoch [21/2000], Loss: 3.5002, UL AUC: 0.7137, ACC AUC: 0.8010, ACC NDCG@20: 0.2228, Current time: 2.37min
[RecUL] Epoch [22/2000], Loss: 3.4657, UL AUC: 0.7106, ACC AUC: 0.8016, ACC NDCG@20: 0.2226, Current time: 2.51min
[RecUL] Epoch [23/2000], Loss: 3.4479, UL AUC: 0.7243, ACC AUC: 0.7978, ACC NDCG@20: 0.2225, Current time: 2.65min
[RecUL] Epoch [24/2000], Loss: 3.4411, UL AUC: 0.7243, ACC AUC: 0.7969, ACC NDCG@20: 0.2228, Current time: 2.72min
[RecUL] Epoch [25/2000], Loss: 3.4254, UL AUC: 0.7246, ACC AUC: 0.8002, ACC NDCG@20: 0.2229, Current time: 2.80min
[RecUL] Epoch [26/2000], Loss: 3.4335, UL AUC: 0.7264, ACC AUC: 0.7985, ACC NDCG@20: 0.2230, Current time: 2.92min
[RecUL] Epoch [27/2000], Loss: 3.4398, UL AUC: 0.7399, ACC AUC: 0.7931, ACC NDCG@20: 0.2233, Current time: 3.05min
[RecUL] Epoch [28/2000], Loss: 3.4473, UL AUC: 0.7426, ACC AUC: 0.7930, ACC NDCG@20: 0.2235, Current time: 3.19min
[RecUL] Epoch [29/2000], Loss: 3.4123, UL AUC: 0.7366, ACC AUC: 0.7958, ACC NDCG@20: 0.2231, Current time: 3.32min
[RecUL] Epoch [30/2000], Loss: 3.4170, UL AUC: 0.7468, ACC AUC: 0.7914, ACC NDCG@20: 0.2231, Current time: 3.34min
[RecUL] Epoch [31/2000], Loss: 3.3980, UL AUC: 0.7481, ACC AUC: 0.7913, ACC NDCG@20: 0.2233, Current time: 3.48min
[RecUL] Epoch [32/2000], Loss: 3.4126, UL AUC: 0.7582, ACC AUC: 0.7898, ACC NDCG@20: 0.2235, Current time: 3.61min
[RecUL] Epoch [33/2000], Loss: 3.4090, UL AUC: 0.7477, ACC AUC: 0.7962, ACC NDCG@20: 0.2238, Current time: 3.73min
[RecUL] Epoch [34/2000], Loss: 3.3885, UL AUC: 0.7473, ACC AUC: 0.7959, ACC NDCG@20: 0.2237, Current time: 3.86min
[RecUL] Epoch [35/2000], Loss: 3.3790, UL AUC: 0.7674, ACC AUC: 0.7905, ACC NDCG@20: 0.2237, Current time: 3.88min
[RecUL] Epoch [36/2000], Loss: 3.3987, UL AUC: 0.7569, ACC AUC: 0.7942, ACC NDCG@20: 0.2241, Current time: 4.02min
[RecUL] Epoch [37/2000], Loss: 3.3994, UL AUC: 0.7594, ACC AUC: 0.7922, ACC NDCG@20: 0.2242, Current time: 4.16min
[RecUL] Epoch [38/2000], Loss: 3.3884, UL AUC: 0.7674, ACC AUC: 0.7901, ACC NDCG@20: 0.2241, Current time: 4.26min
[RecUL] Epoch [39/2000], Loss: 3.3831, UL AUC: 0.7644, ACC AUC: 0.7922, ACC NDCG@20: 0.2242, Current time: 4.40min
[RecUL] Epoch [40/2000], Loss: 3.3578, UL AUC: 0.7671, ACC AUC: 0.7906, ACC NDCG@20: 0.2245, Current time: 4.52min
[RecUL] Epoch [41/2000], Loss: 3.3483, UL AUC: 0.7747, ACC AUC: 0.7878, ACC NDCG@20: 0.2243, Current time: 4.64min
[RecUL] Epoch [42/2000], Loss: 3.3498, UL AUC: 0.7640, ACC AUC: 0.7887, ACC NDCG@20: 0.2246, Current time: 4.68min
[RecUL] Epoch [43/2000], Loss: 3.3850, UL AUC: 0.7798, ACC AUC: 0.7814, ACC NDCG@20: 0.2243, Current time: 4.70min
[RecUL] Epoch [44/2000], Loss: 3.3621, UL AUC: 0.7706, ACC AUC: 0.7891, ACC NDCG@20: 0.2242, Current time: 4.84min
[RecUL] Epoch [45/2000], Loss: 3.3638, UL AUC: 0.7754, ACC AUC: 0.7922, ACC NDCG@20: 0.2242, Current time: 4.95min
[RecUL] Epoch [46/2000], Loss: 3.3666, UL AUC: 0.7732, ACC AUC: 0.7892, ACC NDCG@20: 0.2243, Current time: 5.05min
[RecUL] Epoch [47/2000], Loss: 3.3488, UL AUC: 0.7748, ACC AUC: 0.7930, ACC NDCG@20: 0.2243, Current time: 5.18min
[RecUL] Epoch [48/2000], Loss: 3.3493, UL AUC: 0.7876, ACC AUC: 0.7872, ACC NDCG@20: 0.2241, Current time: 5.32min
[RecUL] Epoch [49/2000], Loss: 3.3368, UL AUC: 0.7792, ACC AUC: 0.7896, ACC NDCG@20: 0.2242, Current time: 5.43min
[RecUL] Epoch [50/2000], Loss: 3.3384, UL AUC: 0.7790, ACC AUC: 0.7866, ACC NDCG@20: 0.2244, Current time: 5.45min
[RecUL] Epoch [51/2000], Loss: 3.3596, UL AUC: 0.7799, ACC AUC: 0.7856, ACC NDCG@20: 0.2244, Current time: 5.47min
[RecUL] Epoch [52/2000], Loss: 3.3584, UL AUC: 0.7746, ACC AUC: 0.7836, ACC NDCG@20: 0.2244, Current time: 5.60min
[RecUL] Epoch [53/2000], Loss: 3.3615, UL AUC: 0.7740, ACC AUC: 0.7893, ACC NDCG@20: 0.2243, Current time: 5.74min
[RecUL] Epoch [54/2000], Loss: 3.3288, UL AUC: 0.7859, ACC AUC: 0.7854, ACC NDCG@20: 0.2240, Current time: 5.89min
[RecUL] Epoch [55/2000], Loss: 3.3635, UL AUC: 0.7846, ACC AUC: 0.7902, ACC NDCG@20: 0.2241, Current time: 6.01min
[RecUL] Epoch [56/2000], Loss: 3.3533, UL AUC: 0.7872, ACC AUC: 0.7836, ACC NDCG@20: 0.2242, Current time: 6.13min
[RecUL] Epoch [57/2000], Loss: 3.3576, UL AUC: 0.7875, ACC AUC: 0.7828, ACC NDCG@20: 0.2241, Current time: 6.25min
[RecUL] Epoch [58/2000], Loss: 3.3511, UL AUC: 0.7846, ACC AUC: 0.7837, ACC NDCG@20: 0.2239, Current time: 6.38min
Best UL AUC: 0.7876, Best epoch: 47, total time: 6.51min
[RECUL] TRAINING FINISHED. TOTAL TIME: 6.69min.
Precision@20: 0.2106; Recall@20: 0.1404;  NDCG@20: 0.2252;  
Precision@50: 0.1701; Recall@50: 0.2836;  NDCG@50: 0.2654;  
Precision@100: 0.1289; Recall@100: 0.4298;  NDCG@100: 0.3430;  
Before unlearning: ACC AUC: 0.8614, UL AUC: 0.5083, ACC NDCG@20: 0.2260
After unlearning: ACC AUC: 0.7872, UL AUC: 0.7876, ACC NDCG@20: 0.2252
