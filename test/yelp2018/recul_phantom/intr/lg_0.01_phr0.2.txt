Read yelp2018 dataset done! u_num: 31668, i_num: 38048
Load a pre-trained model
UL AUC before unlearning: 0.5021
ACC AUC before unlearning: 0.9280
NDCG@20 before unlearning: 0.0460
Start phantom user assignment k-means!
Finish phantom user assignment k-means!
AUC before unlearning: 0.6507
NDCG@20 before unlearning: 0.0457
[RECUL] START TRAINING. CURRENT TIME: 0.22min.
[RECUL] PREPROCESS FINISHED. CURRENT TIME: 0.05min.
[RecUL] Epoch [1/2000], Loss: 1.5654, UL AUC: 0.7181, ACC AUC: 0.8361, ACC NDCG@20: 0.0461, Current time: 0.27min
[RecUL] Epoch [2/2000], Loss: 0.9849, UL AUC: 0.7139, ACC AUC: 0.8611, ACC NDCG@20: 0.0460, Current time: 0.47min
[RecUL] Epoch [3/2000], Loss: 0.9107, UL AUC: 0.7075, ACC AUC: 0.8766, ACC NDCG@20: 0.0461, Current time: 0.67min
[RecUL] Epoch [4/2000], Loss: 0.8513, UL AUC: 0.7116, ACC AUC: 0.8873, ACC NDCG@20: 0.0461, Current time: 0.87min
[RecUL] Epoch [5/2000], Loss: 0.8304, UL AUC: 0.7245, ACC AUC: 0.8921, ACC NDCG@20: 0.0461, Current time: 1.07min
[RecUL] Epoch [6/2000], Loss: 0.7795, UL AUC: 0.7231, ACC AUC: 0.8952, ACC NDCG@20: 0.0461, Current time: 1.26min
[RecUL] Epoch [7/2000], Loss: 0.7541, UL AUC: 0.7426, ACC AUC: 0.8944, ACC NDCG@20: 0.0463, Current time: 1.46min
[RecUL] Epoch [8/2000], Loss: 0.7208, UL AUC: 0.7332, ACC AUC: 0.8984, ACC NDCG@20: 0.0463, Current time: 1.66min
[RecUL] Epoch [9/2000], Loss: 0.7190, UL AUC: 0.7366, ACC AUC: 0.9009, ACC NDCG@20: 0.0462, Current time: 1.86min
[RecUL] Epoch [10/2000], Loss: 0.6985, UL AUC: 0.7481, ACC AUC: 0.8982, ACC NDCG@20: 0.0462, Current time: 2.05min
[RecUL] Epoch [11/2000], Loss: 0.7020, UL AUC: 0.7305, ACC AUC: 0.9036, ACC NDCG@20: 0.0463, Current time: 2.25min
[RecUL] Epoch [12/2000], Loss: 0.6727, UL AUC: 0.7523, ACC AUC: 0.8997, ACC NDCG@20: 0.0463, Current time: 2.44min
[RecUL] Epoch [13/2000], Loss: 0.6611, UL AUC: 0.7616, ACC AUC: 0.9043, ACC NDCG@20: 0.0463, Current time: 2.64min
[RecUL] Epoch [14/2000], Loss: 0.6425, UL AUC: 0.7682, ACC AUC: 0.9035, ACC NDCG@20: 0.0463, Current time: 2.84min
[RecUL] Epoch [15/2000], Loss: 0.6373, UL AUC: 0.7529, ACC AUC: 0.9018, ACC NDCG@20: 0.0463, Current time: 3.04min
[RecUL] Epoch [16/2000], Loss: 0.6433, UL AUC: 0.7531, ACC AUC: 0.9044, ACC NDCG@20: 0.0461, Current time: 3.23min
[RecUL] Epoch [17/2000], Loss: 0.6060, UL AUC: 0.7582, ACC AUC: 0.9073, ACC NDCG@20: 0.0461, Current time: 3.43min
[RecUL] Epoch [18/2000], Loss: 0.6128, UL AUC: 0.7738, ACC AUC: 0.9050, ACC NDCG@20: 0.0460, Current time: 3.63min
[RecUL] Epoch [19/2000], Loss: 0.5838, UL AUC: 0.7744, ACC AUC: 0.9068, ACC NDCG@20: 0.0461, Current time: 3.83min
[RecUL] Epoch [20/2000], Loss: 0.5803, UL AUC: 0.7602, ACC AUC: 0.9090, ACC NDCG@20: 0.0461, Current time: 4.03min
[RecUL] Epoch [21/2000], Loss: 0.5692, UL AUC: 0.7800, ACC AUC: 0.9089, ACC NDCG@20: 0.0461, Current time: 4.23min
[RecUL] Epoch [22/2000], Loss: 0.5538, UL AUC: 0.7796, ACC AUC: 0.9090, ACC NDCG@20: 0.0461, Current time: 4.43min
[RecUL] Epoch [23/2000], Loss: 0.5446, UL AUC: 0.7898, ACC AUC: 0.9078, ACC NDCG@20: 0.0461, Current time: 4.63min
[RecUL] Epoch [24/2000], Loss: 0.5361, UL AUC: 0.7988, ACC AUC: 0.9055, ACC NDCG@20: 0.0460, Current time: 4.83min
[RecUL] Epoch [25/2000], Loss: 0.5324, UL AUC: 0.7974, ACC AUC: 0.9075, ACC NDCG@20: 0.0460, Current time: 5.03min
[RecUL] Epoch [26/2000], Loss: 0.5107, UL AUC: 0.7818, ACC AUC: 0.9071, ACC NDCG@20: 0.0459, Current time: 5.23min
[RecUL] Epoch [27/2000], Loss: 0.5022, UL AUC: 0.7878, ACC AUC: 0.9089, ACC NDCG@20: 0.0459, Current time: 5.43min
[RecUL] Epoch [28/2000], Loss: 0.4896, UL AUC: 0.8169, ACC AUC: 0.9074, ACC NDCG@20: 0.0459, Current time: 5.63min
[RecUL] Epoch [29/2000], Loss: 0.4663, UL AUC: 0.8242, ACC AUC: 0.9068, ACC NDCG@20: 0.0459, Current time: 5.83min
[RecUL] Epoch [30/2000], Loss: 0.4718, UL AUC: 0.8115, ACC AUC: 0.9090, ACC NDCG@20: 0.0458, Current time: 6.02min
[RecUL] Epoch [31/2000], Loss: 0.4903, UL AUC: 0.8132, ACC AUC: 0.9065, ACC NDCG@20: 0.0458, Current time: 6.22min
[RecUL] Epoch [32/2000], Loss: 0.4612, UL AUC: 0.8142, ACC AUC: 0.9088, ACC NDCG@20: 0.0457, Current time: 6.42min
[RecUL] Epoch [33/2000], Loss: 0.4656, UL AUC: 0.8259, ACC AUC: 0.9077, ACC NDCG@20: 0.0457, Current time: 6.61min
[RecUL] Epoch [34/2000], Loss: 0.4566, UL AUC: 0.8301, ACC AUC: 0.9088, ACC NDCG@20: 0.0456, Current time: 6.81min
[RecUL] Epoch [35/2000], Loss: 0.4530, UL AUC: 0.8436, ACC AUC: 0.9093, ACC NDCG@20: 0.0456, Current time: 7.01min
[RecUL] Epoch [36/2000], Loss: 0.4308, UL AUC: 0.8469, ACC AUC: 0.9100, ACC NDCG@20: 0.0456, Current time: 7.21min
[RecUL] Epoch [37/2000], Loss: 0.4391, UL AUC: 0.8416, ACC AUC: 0.9078, ACC NDCG@20: 0.0455, Current time: 7.41min
[RecUL] Epoch [38/2000], Loss: 0.4205, UL AUC: 0.8391, ACC AUC: 0.9098, ACC NDCG@20: 0.0455, Current time: 7.61min
[RecUL] Epoch [39/2000], Loss: 0.4362, UL AUC: 0.8613, ACC AUC: 0.9073, ACC NDCG@20: 0.0455, Current time: 7.82min
[RecUL] Epoch [40/2000], Loss: 0.4278, UL AUC: 0.8565, ACC AUC: 0.9070, ACC NDCG@20: 0.0454, Current time: 8.02min
[RecUL] Epoch [41/2000], Loss: 0.4159, UL AUC: 0.8571, ACC AUC: 0.9074, ACC NDCG@20: 0.0454, Current time: 8.22min
[RecUL] Epoch [42/2000], Loss: 0.4194, UL AUC: 0.8536, ACC AUC: 0.9090, ACC NDCG@20: 0.0453, Current time: 8.42min
[RecUL] Epoch [43/2000], Loss: 0.3954, UL AUC: 0.8719, ACC AUC: 0.9074, ACC NDCG@20: 0.0452, Current time: 8.62min
[RecUL] Epoch [44/2000], Loss: 0.3819, UL AUC: 0.8761, ACC AUC: 0.9081, ACC NDCG@20: 0.0453, Current time: 8.82min
[RecUL] Epoch [45/2000], Loss: 0.3929, UL AUC: 0.8706, ACC AUC: 0.9099, ACC NDCG@20: 0.0453, Current time: 9.01min
[RecUL] Epoch [46/2000], Loss: 0.3904, UL AUC: 0.8719, ACC AUC: 0.9077, ACC NDCG@20: 0.0452, Current time: 9.21min
[RecUL] Epoch [47/2000], Loss: 0.4029, UL AUC: 0.8602, ACC AUC: 0.9086, ACC NDCG@20: 0.0452, Current time: 9.41min
[RecUL] Epoch [48/2000], Loss: 0.3833, UL AUC: 0.8791, ACC AUC: 0.9068, ACC NDCG@20: 0.0451, Current time: 9.61min
[RecUL] Epoch [49/2000], Loss: 0.3704, UL AUC: 0.8687, ACC AUC: 0.9079, ACC NDCG@20: 0.0451, Current time: 9.80min
[RecUL] Epoch [50/2000], Loss: 0.3606, UL AUC: 0.8785, ACC AUC: 0.9086, ACC NDCG@20: 0.0451, Current time: 10.00min
[RecUL] Epoch [51/2000], Loss: 0.3679, UL AUC: 0.8778, ACC AUC: 0.9096, ACC NDCG@20: 0.0451, Current time: 10.20min
[RecUL] Epoch [52/2000], Loss: 0.3708, UL AUC: 0.8838, ACC AUC: 0.9095, ACC NDCG@20: 0.0451, Current time: 10.39min
[RecUL] Epoch [53/2000], Loss: 0.3571, UL AUC: 0.8890, ACC AUC: 0.9075, ACC NDCG@20: 0.0449, Current time: 10.59min
[RecUL] Epoch [54/2000], Loss: 0.3439, UL AUC: 0.8835, ACC AUC: 0.9073, ACC NDCG@20: 0.0449, Current time: 10.79min
[RecUL] Epoch [55/2000], Loss: 0.3473, UL AUC: 0.8976, ACC AUC: 0.9088, ACC NDCG@20: 0.0449, Current time: 10.99min
[RecUL] Epoch [56/2000], Loss: 0.3434, UL AUC: 0.8785, ACC AUC: 0.9087, ACC NDCG@20: 0.0449, Current time: 11.18min
[RecUL] Epoch [57/2000], Loss: 0.3483, UL AUC: 0.8906, ACC AUC: 0.9069, ACC NDCG@20: 0.0450, Current time: 11.38min
[RecUL] Epoch [58/2000], Loss: 0.3369, UL AUC: 0.8829, ACC AUC: 0.9075, ACC NDCG@20: 0.0449, Current time: 11.58min
[RecUL] Epoch [59/2000], Loss: 0.3348, UL AUC: 0.8848, ACC AUC: 0.9087, ACC NDCG@20: 0.0448, Current time: 11.78min
[RecUL] Epoch [60/2000], Loss: 0.3404, UL AUC: 0.8975, ACC AUC: 0.9066, ACC NDCG@20: 0.0448, Current time: 11.98min
[RecUL] Epoch [61/2000], Loss: 0.3416, UL AUC: 0.8967, ACC AUC: 0.9079, ACC NDCG@20: 0.0448, Current time: 12.18min
[RecUL] Epoch [62/2000], Loss: 0.3150, UL AUC: 0.8859, ACC AUC: 0.9097, ACC NDCG@20: 0.0447, Current time: 12.37min
[RecUL] Epoch [63/2000], Loss: 0.3216, UL AUC: 0.8954, ACC AUC: 0.9071, ACC NDCG@20: 0.0446, Current time: 12.57min
[RecUL] Epoch [64/2000], Loss: 0.3519, UL AUC: 0.8882, ACC AUC: 0.9082, ACC NDCG@20: 0.0445, Current time: 12.77min
[RecUL] Epoch [65/2000], Loss: 0.3188, UL AUC: 0.8959, ACC AUC: 0.9074, ACC NDCG@20: 0.0445, Current time: 12.97min
Best UL AUC: 0.8976, Best epoch: 54, total time: 13.16min
[RECUL] TRAINING FINISHED. TOTAL TIME: 13.39min.
Precision@20: 0.0252; Recall@20: 0.0552;  NDCG@20: 0.0450;  
Precision@50: 0.0201; Recall@50: 0.1093;  NDCG@50: 0.0652;  
Precision@100: 0.0161; Recall@100: 0.1728;  NDCG@100: 0.0860;  
Before unlearning: ACC AUC: 0.9280, UL AUC: 0.5021, ACC NDCG@20: 0.0460
After unlearning: ACC AUC: 0.9088, UL AUC: 0.8976, ACC NDCG@20: 0.0450
