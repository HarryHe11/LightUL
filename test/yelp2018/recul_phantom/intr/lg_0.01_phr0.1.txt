Read yelp2018 dataset done! u_num: 31668, i_num: 38048
Load a pre-trained model
UL AUC before unlearning: 0.5021
ACC AUC before unlearning: 0.9280
NDCG@20 before unlearning: 0.0460
Start phantom user assignment k-means!
Finish phantom user assignment k-means!
AUC before unlearning: 0.6507
NDCG@20 before unlearning: 0.0457
[RECUL] START TRAINING. CURRENT TIME: 0.23min.
[RECUL] PREPROCESS FINISHED. CURRENT TIME: 0.06min.
[RecUL] Epoch [1/2000], Loss: 1.5848, UL AUC: 0.7176, ACC AUC: 0.8417, ACC NDCG@20: 0.0460, Current time: 0.28min
[RecUL] Epoch [2/2000], Loss: 1.0258, UL AUC: 0.7143, ACC AUC: 0.8651, ACC NDCG@20: 0.0460, Current time: 0.48min
[RecUL] Epoch [3/2000], Loss: 0.9005, UL AUC: 0.7061, ACC AUC: 0.8778, ACC NDCG@20: 0.0461, Current time: 0.68min
[RecUL] Epoch [4/2000], Loss: 0.8515, UL AUC: 0.7185, ACC AUC: 0.8875, ACC NDCG@20: 0.0461, Current time: 0.88min
[RecUL] Epoch [5/2000], Loss: 0.8114, UL AUC: 0.7138, ACC AUC: 0.8902, ACC NDCG@20: 0.0462, Current time: 1.08min
[RecUL] Epoch [6/2000], Loss: 0.7698, UL AUC: 0.7307, ACC AUC: 0.8951, ACC NDCG@20: 0.0461, Current time: 1.28min
[RecUL] Epoch [7/2000], Loss: 0.7567, UL AUC: 0.7434, ACC AUC: 0.8916, ACC NDCG@20: 0.0462, Current time: 1.48min
[RecUL] Epoch [8/2000], Loss: 0.7295, UL AUC: 0.7225, ACC AUC: 0.8967, ACC NDCG@20: 0.0462, Current time: 1.68min
[RecUL] Epoch [9/2000], Loss: 0.7240, UL AUC: 0.7366, ACC AUC: 0.9010, ACC NDCG@20: 0.0462, Current time: 1.88min
[RecUL] Epoch [10/2000], Loss: 0.6967, UL AUC: 0.7281, ACC AUC: 0.8993, ACC NDCG@20: 0.0462, Current time: 2.08min
[RecUL] Epoch [11/2000], Loss: 0.6834, UL AUC: 0.7404, ACC AUC: 0.9018, ACC NDCG@20: 0.0463, Current time: 2.28min
[RecUL] Epoch [12/2000], Loss: 0.6585, UL AUC: 0.7461, ACC AUC: 0.9024, ACC NDCG@20: 0.0463, Current time: 2.48min
[RecUL] Epoch [13/2000], Loss: 0.6559, UL AUC: 0.7476, ACC AUC: 0.9034, ACC NDCG@20: 0.0463, Current time: 2.68min
[RecUL] Epoch [14/2000], Loss: 0.6424, UL AUC: 0.7554, ACC AUC: 0.9048, ACC NDCG@20: 0.0463, Current time: 2.88min
[RecUL] Epoch [15/2000], Loss: 0.6251, UL AUC: 0.7487, ACC AUC: 0.9046, ACC NDCG@20: 0.0464, Current time: 3.08min
[RecUL] Epoch [16/2000], Loss: 0.6744, UL AUC: 0.7472, ACC AUC: 0.9044, ACC NDCG@20: 0.0464, Current time: 3.28min
[RecUL] Epoch [17/2000], Loss: 0.6455, UL AUC: 0.7629, ACC AUC: 0.9064, ACC NDCG@20: 0.0463, Current time: 3.48min
[RecUL] Epoch [18/2000], Loss: 0.6116, UL AUC: 0.7639, ACC AUC: 0.9053, ACC NDCG@20: 0.0463, Current time: 3.67min
[RecUL] Epoch [19/2000], Loss: 0.5997, UL AUC: 0.7631, ACC AUC: 0.9092, ACC NDCG@20: 0.0462, Current time: 3.87min
[RecUL] Epoch [20/2000], Loss: 0.5947, UL AUC: 0.7735, ACC AUC: 0.9098, ACC NDCG@20: 0.0461, Current time: 4.08min
[RecUL] Epoch [21/2000], Loss: 0.5721, UL AUC: 0.7908, ACC AUC: 0.9065, ACC NDCG@20: 0.0461, Current time: 4.28min
[RecUL] Epoch [22/2000], Loss: 0.5694, UL AUC: 0.7938, ACC AUC: 0.9072, ACC NDCG@20: 0.0462, Current time: 4.48min
[RecUL] Epoch [23/2000], Loss: 0.5293, UL AUC: 0.7886, ACC AUC: 0.9089, ACC NDCG@20: 0.0461, Current time: 4.68min
[RecUL] Epoch [24/2000], Loss: 0.5559, UL AUC: 0.7977, ACC AUC: 0.9059, ACC NDCG@20: 0.0461, Current time: 4.87min
[RecUL] Epoch [25/2000], Loss: 0.5431, UL AUC: 0.8012, ACC AUC: 0.9083, ACC NDCG@20: 0.0460, Current time: 5.07min
[RecUL] Epoch [26/2000], Loss: 0.5193, UL AUC: 0.7788, ACC AUC: 0.9082, ACC NDCG@20: 0.0460, Current time: 5.27min
[RecUL] Epoch [27/2000], Loss: 0.5107, UL AUC: 0.7993, ACC AUC: 0.9070, ACC NDCG@20: 0.0459, Current time: 5.47min
[RecUL] Epoch [28/2000], Loss: 0.5094, UL AUC: 0.8095, ACC AUC: 0.9080, ACC NDCG@20: 0.0459, Current time: 5.66min
[RecUL] Epoch [29/2000], Loss: 0.4954, UL AUC: 0.8150, ACC AUC: 0.9073, ACC NDCG@20: 0.0459, Current time: 5.86min
[RecUL] Epoch [30/2000], Loss: 0.4644, UL AUC: 0.8163, ACC AUC: 0.9084, ACC NDCG@20: 0.0458, Current time: 6.06min
[RecUL] Epoch [31/2000], Loss: 0.4726, UL AUC: 0.8269, ACC AUC: 0.9087, ACC NDCG@20: 0.0458, Current time: 6.26min
[RecUL] Epoch [32/2000], Loss: 0.4561, UL AUC: 0.8344, ACC AUC: 0.9085, ACC NDCG@20: 0.0458, Current time: 6.46min
[RecUL] Epoch [33/2000], Loss: 0.4574, UL AUC: 0.8299, ACC AUC: 0.9064, ACC NDCG@20: 0.0457, Current time: 6.66min
[RecUL] Epoch [34/2000], Loss: 0.4534, UL AUC: 0.8191, ACC AUC: 0.9086, ACC NDCG@20: 0.0458, Current time: 6.86min
[RecUL] Epoch [35/2000], Loss: 0.4189, UL AUC: 0.8522, ACC AUC: 0.9108, ACC NDCG@20: 0.0456, Current time: 7.06min
[RecUL] Epoch [36/2000], Loss: 0.4166, UL AUC: 0.8583, ACC AUC: 0.9085, ACC NDCG@20: 0.0456, Current time: 7.25min
[RecUL] Epoch [37/2000], Loss: 0.4250, UL AUC: 0.8510, ACC AUC: 0.9093, ACC NDCG@20: 0.0455, Current time: 7.45min
[RecUL] Epoch [38/2000], Loss: 0.4322, UL AUC: 0.8453, ACC AUC: 0.9089, ACC NDCG@20: 0.0454, Current time: 7.65min
[RecUL] Epoch [39/2000], Loss: 0.4197, UL AUC: 0.8460, ACC AUC: 0.9075, ACC NDCG@20: 0.0455, Current time: 7.84min
[RecUL] Epoch [40/2000], Loss: 0.4037, UL AUC: 0.8534, ACC AUC: 0.9085, ACC NDCG@20: 0.0455, Current time: 8.04min
[RecUL] Epoch [41/2000], Loss: 0.4150, UL AUC: 0.8701, ACC AUC: 0.9073, ACC NDCG@20: 0.0454, Current time: 8.24min
[RecUL] Epoch [42/2000], Loss: 0.4137, UL AUC: 0.8632, ACC AUC: 0.9066, ACC NDCG@20: 0.0454, Current time: 8.43min
[RecUL] Epoch [43/2000], Loss: 0.4063, UL AUC: 0.8584, ACC AUC: 0.9075, ACC NDCG@20: 0.0454, Current time: 8.63min
[RecUL] Epoch [44/2000], Loss: 0.3927, UL AUC: 0.8654, ACC AUC: 0.9080, ACC NDCG@20: 0.0453, Current time: 8.83min
[RecUL] Epoch [45/2000], Loss: 0.3917, UL AUC: 0.8694, ACC AUC: 0.9088, ACC NDCG@20: 0.0453, Current time: 9.02min
[RecUL] Epoch [46/2000], Loss: 0.3918, UL AUC: 0.8728, ACC AUC: 0.9077, ACC NDCG@20: 0.0453, Current time: 9.22min
[RecUL] Epoch [47/2000], Loss: 0.3969, UL AUC: 0.8523, ACC AUC: 0.9091, ACC NDCG@20: 0.0453, Current time: 9.42min
[RecUL] Epoch [48/2000], Loss: 0.3781, UL AUC: 0.8760, ACC AUC: 0.9071, ACC NDCG@20: 0.0453, Current time: 9.62min
[RecUL] Epoch [49/2000], Loss: 0.3681, UL AUC: 0.8773, ACC AUC: 0.9081, ACC NDCG@20: 0.0453, Current time: 9.82min
[RecUL] Epoch [50/2000], Loss: 0.3669, UL AUC: 0.8659, ACC AUC: 0.9105, ACC NDCG@20: 0.0453, Current time: 10.02min
[RecUL] Epoch [51/2000], Loss: 0.3762, UL AUC: 0.8771, ACC AUC: 0.9075, ACC NDCG@20: 0.0453, Current time: 10.22min
[RecUL] Epoch [52/2000], Loss: 0.3787, UL AUC: 0.8833, ACC AUC: 0.9086, ACC NDCG@20: 0.0451, Current time: 10.41min
[RecUL] Epoch [53/2000], Loss: 0.3632, UL AUC: 0.8859, ACC AUC: 0.9076, ACC NDCG@20: 0.0450, Current time: 10.61min
[RecUL] Epoch [54/2000], Loss: 0.3532, UL AUC: 0.8834, ACC AUC: 0.9093, ACC NDCG@20: 0.0451, Current time: 10.81min
[RecUL] Epoch [55/2000], Loss: 0.3383, UL AUC: 0.8952, ACC AUC: 0.9084, ACC NDCG@20: 0.0451, Current time: 11.02min
[RecUL] Epoch [56/2000], Loss: 0.3530, UL AUC: 0.8857, ACC AUC: 0.9091, ACC NDCG@20: 0.0450, Current time: 11.22min
[RecUL] Epoch [57/2000], Loss: 0.3463, UL AUC: 0.8879, ACC AUC: 0.9089, ACC NDCG@20: 0.0449, Current time: 11.42min
[RecUL] Epoch [58/2000], Loss: 0.3370, UL AUC: 0.8870, ACC AUC: 0.9073, ACC NDCG@20: 0.0449, Current time: 11.62min
[RecUL] Epoch [59/2000], Loss: 0.3344, UL AUC: 0.8897, ACC AUC: 0.9070, ACC NDCG@20: 0.0449, Current time: 11.82min
[RecUL] Epoch [60/2000], Loss: 0.3465, UL AUC: 0.8991, ACC AUC: 0.9072, ACC NDCG@20: 0.0449, Current time: 12.02min
[RecUL] Epoch [61/2000], Loss: 0.3554, UL AUC: 0.8985, ACC AUC: 0.9082, ACC NDCG@20: 0.0449, Current time: 12.21min
[RecUL] Epoch [62/2000], Loss: 0.3284, UL AUC: 0.8798, ACC AUC: 0.9095, ACC NDCG@20: 0.0448, Current time: 12.41min
[RecUL] Epoch [63/2000], Loss: 0.3329, UL AUC: 0.8923, ACC AUC: 0.9066, ACC NDCG@20: 0.0448, Current time: 12.60min
[RecUL] Epoch [64/2000], Loss: 0.3634, UL AUC: 0.8842, ACC AUC: 0.9074, ACC NDCG@20: 0.0447, Current time: 12.80min
[RecUL] Epoch [65/2000], Loss: 0.3248, UL AUC: 0.8983, ACC AUC: 0.9080, ACC NDCG@20: 0.0448, Current time: 12.99min
Best UL AUC: 0.8952, Best epoch: 54, total time: 13.19min
[RECUL] TRAINING FINISHED. TOTAL TIME: 13.42min.
Precision@20: 0.0251; Recall@20: 0.0553;  NDCG@20: 0.0452;  
Precision@50: 0.0201; Recall@50: 0.1093;  NDCG@50: 0.0654;  
Precision@100: 0.0161; Recall@100: 0.1729;  NDCG@100: 0.0862;  
Before unlearning: ACC AUC: 0.9280, UL AUC: 0.5021, ACC NDCG@20: 0.0460
After unlearning: ACC AUC: 0.9084, UL AUC: 0.8952, ACC NDCG@20: 0.0452
