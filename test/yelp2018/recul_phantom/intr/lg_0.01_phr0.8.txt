Read yelp2018 dataset done! u_num: 31668, i_num: 38048
Load a pre-trained model
UL AUC before unlearning: 0.5021
ACC AUC before unlearning: 0.9280
NDCG@20 before unlearning: 0.0460
Start phantom user assignment k-means!
Finish phantom user assignment k-means!
AUC before unlearning: 0.6507
NDCG@20 before unlearning: 0.0457
[RECUL] START TRAINING. CURRENT TIME: 0.23min.
[RECUL] PREPROCESS FINISHED. CURRENT TIME: 0.06min.
[RecUL] Epoch [1/2000], Loss: 1.5595, UL AUC: 0.7155, ACC AUC: 0.8421, ACC NDCG@20: 0.0461, Current time: 0.28min
[RecUL] Epoch [2/2000], Loss: 0.9765, UL AUC: 0.7181, ACC AUC: 0.8648, ACC NDCG@20: 0.0461, Current time: 0.47min
[RecUL] Epoch [3/2000], Loss: 0.9106, UL AUC: 0.7071, ACC AUC: 0.8812, ACC NDCG@20: 0.0461, Current time: 0.68min
[RecUL] Epoch [4/2000], Loss: 0.8440, UL AUC: 0.7178, ACC AUC: 0.8887, ACC NDCG@20: 0.0462, Current time: 0.87min
[RecUL] Epoch [5/2000], Loss: 0.8199, UL AUC: 0.7302, ACC AUC: 0.8926, ACC NDCG@20: 0.0462, Current time: 1.08min
[RecUL] Epoch [6/2000], Loss: 0.7737, UL AUC: 0.7276, ACC AUC: 0.8966, ACC NDCG@20: 0.0463, Current time: 1.28min
[RecUL] Epoch [7/2000], Loss: 0.7493, UL AUC: 0.7460, ACC AUC: 0.8957, ACC NDCG@20: 0.0463, Current time: 1.48min
[RecUL] Epoch [8/2000], Loss: 0.7173, UL AUC: 0.7317, ACC AUC: 0.8997, ACC NDCG@20: 0.0463, Current time: 1.68min
[RecUL] Epoch [9/2000], Loss: 0.7116, UL AUC: 0.7369, ACC AUC: 0.9019, ACC NDCG@20: 0.0463, Current time: 1.87min
[RecUL] Epoch [10/2000], Loss: 0.6946, UL AUC: 0.7517, ACC AUC: 0.8995, ACC NDCG@20: 0.0463, Current time: 2.07min
[RecUL] Epoch [11/2000], Loss: 0.6960, UL AUC: 0.7328, ACC AUC: 0.9038, ACC NDCG@20: 0.0463, Current time: 2.27min
[RecUL] Epoch [12/2000], Loss: 0.6642, UL AUC: 0.7580, ACC AUC: 0.9013, ACC NDCG@20: 0.0463, Current time: 2.47min
[RecUL] Epoch [13/2000], Loss: 0.6492, UL AUC: 0.7622, ACC AUC: 0.9050, ACC NDCG@20: 0.0463, Current time: 2.67min
[RecUL] Epoch [14/2000], Loss: 0.6413, UL AUC: 0.7757, ACC AUC: 0.9044, ACC NDCG@20: 0.0462, Current time: 2.87min
[RecUL] Epoch [15/2000], Loss: 0.6383, UL AUC: 0.7557, ACC AUC: 0.9049, ACC NDCG@20: 0.0463, Current time: 3.07min
[RecUL] Epoch [16/2000], Loss: 0.6370, UL AUC: 0.7560, ACC AUC: 0.9065, ACC NDCG@20: 0.0462, Current time: 3.26min
[RecUL] Epoch [17/2000], Loss: 0.5994, UL AUC: 0.7634, ACC AUC: 0.9084, ACC NDCG@20: 0.0462, Current time: 3.46min
[RecUL] Epoch [18/2000], Loss: 0.6122, UL AUC: 0.7814, ACC AUC: 0.9055, ACC NDCG@20: 0.0461, Current time: 3.65min
[RecUL] Epoch [19/2000], Loss: 0.5795, UL AUC: 0.7809, ACC AUC: 0.9078, ACC NDCG@20: 0.0461, Current time: 3.85min
[RecUL] Epoch [20/2000], Loss: 0.5713, UL AUC: 0.7711, ACC AUC: 0.9110, ACC NDCG@20: 0.0461, Current time: 4.05min
[RecUL] Epoch [21/2000], Loss: 0.5603, UL AUC: 0.7884, ACC AUC: 0.9098, ACC NDCG@20: 0.0460, Current time: 4.25min
[RecUL] Epoch [22/2000], Loss: 0.5556, UL AUC: 0.7868, ACC AUC: 0.9105, ACC NDCG@20: 0.0459, Current time: 4.44min
[RecUL] Epoch [23/2000], Loss: 0.5394, UL AUC: 0.7940, ACC AUC: 0.9092, ACC NDCG@20: 0.0459, Current time: 4.64min
[RecUL] Epoch [24/2000], Loss: 0.5364, UL AUC: 0.8046, ACC AUC: 0.9071, ACC NDCG@20: 0.0459, Current time: 4.84min
[RecUL] Epoch [25/2000], Loss: 0.5263, UL AUC: 0.8070, ACC AUC: 0.9105, ACC NDCG@20: 0.0459, Current time: 5.04min
[RecUL] Epoch [26/2000], Loss: 0.5010, UL AUC: 0.7976, ACC AUC: 0.9109, ACC NDCG@20: 0.0458, Current time: 5.23min
[RecUL] Epoch [27/2000], Loss: 0.4958, UL AUC: 0.7976, ACC AUC: 0.9096, ACC NDCG@20: 0.0459, Current time: 5.43min
[RecUL] Epoch [28/2000], Loss: 0.4871, UL AUC: 0.8230, ACC AUC: 0.9077, ACC NDCG@20: 0.0458, Current time: 5.62min
[RecUL] Epoch [29/2000], Loss: 0.4662, UL AUC: 0.8209, ACC AUC: 0.9084, ACC NDCG@20: 0.0458, Current time: 5.82min
[RecUL] Epoch [30/2000], Loss: 0.4753, UL AUC: 0.8242, ACC AUC: 0.9083, ACC NDCG@20: 0.0457, Current time: 6.02min
[RecUL] Epoch [31/2000], Loss: 0.4882, UL AUC: 0.8181, ACC AUC: 0.9067, ACC NDCG@20: 0.0457, Current time: 6.21min
[RecUL] Epoch [32/2000], Loss: 0.4456, UL AUC: 0.8275, ACC AUC: 0.9096, ACC NDCG@20: 0.0457, Current time: 6.41min
[RecUL] Epoch [33/2000], Loss: 0.4522, UL AUC: 0.8354, ACC AUC: 0.9073, ACC NDCG@20: 0.0456, Current time: 6.60min
[RecUL] Epoch [34/2000], Loss: 0.4531, UL AUC: 0.8336, ACC AUC: 0.9093, ACC NDCG@20: 0.0455, Current time: 6.80min
[RecUL] Epoch [35/2000], Loss: 0.4430, UL AUC: 0.8531, ACC AUC: 0.9084, ACC NDCG@20: 0.0455, Current time: 7.01min
[RecUL] Epoch [36/2000], Loss: 0.4288, UL AUC: 0.8565, ACC AUC: 0.9114, ACC NDCG@20: 0.0455, Current time: 7.20min
[RecUL] Epoch [37/2000], Loss: 0.4414, UL AUC: 0.8532, ACC AUC: 0.9109, ACC NDCG@20: 0.0454, Current time: 7.40min
[RecUL] Epoch [38/2000], Loss: 0.4080, UL AUC: 0.8514, ACC AUC: 0.9117, ACC NDCG@20: 0.0454, Current time: 7.59min
[RecUL] Epoch [39/2000], Loss: 0.4479, UL AUC: 0.8515, ACC AUC: 0.9099, ACC NDCG@20: 0.0453, Current time: 7.79min
[RecUL] Epoch [40/2000], Loss: 0.4384, UL AUC: 0.8633, ACC AUC: 0.9074, ACC NDCG@20: 0.0453, Current time: 7.99min
[RecUL] Epoch [41/2000], Loss: 0.4254, UL AUC: 0.8691, ACC AUC: 0.9092, ACC NDCG@20: 0.0453, Current time: 8.18min
[RecUL] Epoch [42/2000], Loss: 0.4167, UL AUC: 0.8636, ACC AUC: 0.9094, ACC NDCG@20: 0.0452, Current time: 8.38min
[RecUL] Epoch [43/2000], Loss: 0.3896, UL AUC: 0.8704, ACC AUC: 0.9092, ACC NDCG@20: 0.0451, Current time: 8.57min
[RecUL] Epoch [44/2000], Loss: 0.3757, UL AUC: 0.8801, ACC AUC: 0.9096, ACC NDCG@20: 0.0450, Current time: 8.77min
[RecUL] Epoch [45/2000], Loss: 0.3904, UL AUC: 0.8724, ACC AUC: 0.9103, ACC NDCG@20: 0.0450, Current time: 8.97min
[RecUL] Epoch [46/2000], Loss: 0.3736, UL AUC: 0.8777, ACC AUC: 0.9095, ACC NDCG@20: 0.0450, Current time: 9.17min
[RecUL] Epoch [47/2000], Loss: 0.3972, UL AUC: 0.8549, ACC AUC: 0.9106, ACC NDCG@20: 0.0450, Current time: 9.36min
[RecUL] Epoch [48/2000], Loss: 0.3790, UL AUC: 0.8719, ACC AUC: 0.9079, ACC NDCG@20: 0.0450, Current time: 9.56min
[RecUL] Epoch [49/2000], Loss: 0.3568, UL AUC: 0.8802, ACC AUC: 0.9071, ACC NDCG@20: 0.0450, Current time: 9.75min
[RecUL] Epoch [50/2000], Loss: 0.3514, UL AUC: 0.8755, ACC AUC: 0.9097, ACC NDCG@20: 0.0449, Current time: 9.95min
[RecUL] Epoch [51/2000], Loss: 0.3622, UL AUC: 0.8808, ACC AUC: 0.9102, ACC NDCG@20: 0.0450, Current time: 10.15min
[RecUL] Epoch [52/2000], Loss: 0.3626, UL AUC: 0.8896, ACC AUC: 0.9100, ACC NDCG@20: 0.0448, Current time: 10.35min
[RecUL] Epoch [53/2000], Loss: 0.3510, UL AUC: 0.8856, ACC AUC: 0.9096, ACC NDCG@20: 0.0447, Current time: 10.55min
[RecUL] Epoch [54/2000], Loss: 0.3424, UL AUC: 0.8953, ACC AUC: 0.9094, ACC NDCG@20: 0.0447, Current time: 10.74min
[RecUL] Epoch [55/2000], Loss: 0.3571, UL AUC: 0.8996, ACC AUC: 0.9110, ACC NDCG@20: 0.0447, Current time: 10.94min
[RecUL] Epoch [56/2000], Loss: 0.3357, UL AUC: 0.8817, ACC AUC: 0.9109, ACC NDCG@20: 0.0447, Current time: 11.14min
[RecUL] Epoch [57/2000], Loss: 0.3632, UL AUC: 0.9034, ACC AUC: 0.9080, ACC NDCG@20: 0.0447, Current time: 11.33min
[RecUL] Epoch [58/2000], Loss: 0.3326, UL AUC: 0.8939, ACC AUC: 0.9104, ACC NDCG@20: 0.0447, Current time: 11.53min
[RecUL] Epoch [59/2000], Loss: 0.3313, UL AUC: 0.8948, ACC AUC: 0.9103, ACC NDCG@20: 0.0447, Current time: 11.73min
[RecUL] Epoch [60/2000], Loss: 0.3219, UL AUC: 0.9074, ACC AUC: 0.9080, ACC NDCG@20: 0.0447, Current time: 11.92min
[RecUL] Epoch [61/2000], Loss: 0.3302, UL AUC: 0.9010, ACC AUC: 0.9085, ACC NDCG@20: 0.0446, Current time: 12.12min
[RecUL] Epoch [62/2000], Loss: 0.3133, UL AUC: 0.8890, ACC AUC: 0.9105, ACC NDCG@20: 0.0446, Current time: 12.31min
[RecUL] Epoch [63/2000], Loss: 0.3189, UL AUC: 0.9079, ACC AUC: 0.9090, ACC NDCG@20: 0.0446, Current time: 12.51min
[RecUL] Epoch [64/2000], Loss: 0.3308, UL AUC: 0.9038, ACC AUC: 0.9095, ACC NDCG@20: 0.0446, Current time: 12.71min
[RecUL] Epoch [65/2000], Loss: 0.3122, UL AUC: 0.9001, ACC AUC: 0.9065, ACC NDCG@20: 0.0446, Current time: 12.90min
[RecUL] Epoch [66/2000], Loss: 0.3389, UL AUC: 0.8960, ACC AUC: 0.9112, ACC NDCG@20: 0.0445, Current time: 13.10min
[RecUL] Epoch [67/2000], Loss: 0.3269, UL AUC: 0.9074, ACC AUC: 0.9099, ACC NDCG@20: 0.0445, Current time: 13.29min
[RecUL] Epoch [68/2000], Loss: 0.3074, UL AUC: 0.9095, ACC AUC: 0.9093, ACC NDCG@20: 0.0445, Current time: 13.49min
[RecUL] Epoch [69/2000], Loss: 0.3351, UL AUC: 0.9022, ACC AUC: 0.9069, ACC NDCG@20: 0.0445, Current time: 13.69min
[RecUL] Epoch [70/2000], Loss: 0.3046, UL AUC: 0.9048, ACC AUC: 0.9111, ACC NDCG@20: 0.0445, Current time: 13.89min
Best UL AUC: 0.9074, Best epoch: 59, total time: 14.08min
[RECUL] TRAINING FINISHED. TOTAL TIME: 14.31min.
Precision@20: 0.0250; Recall@20: 0.0549;  NDCG@20: 0.0448;  
Precision@50: 0.0200; Recall@50: 0.1086;  NDCG@50: 0.0648;  
Precision@100: 0.0161; Recall@100: 0.1721;  NDCG@100: 0.0856;  
Before unlearning: ACC AUC: 0.9280, UL AUC: 0.5021, ACC NDCG@20: 0.0460
After unlearning: ACC AUC: 0.9080, UL AUC: 0.9074, ACC NDCG@20: 0.0448
