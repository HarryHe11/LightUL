Read yelp2018 dataset done! u_num: 31668, i_num: 38048
Load a pre-trained model
UL AUC before unlearning: 0.5021
ACC AUC before unlearning: 0.9280
NDCG@20 before unlearning: 0.0460
AUC before unlearning: 0.6507
NDCG@20 before unlearning: 0.0457
[RECUL] START TRAINING. CURRENT TIME: 0.20min.
[RECUL] PREPROCESS FINISHED. CURRENT TIME: 0.01min.
[RecUL] Epoch [1/2000], Loss: 1.4467, UL AUC: 0.7088, ACC AUC: 0.8447, ACC NDCG@20: 0.0460, Current time: 0.19min
[RecUL] Epoch [2/2000], Loss: 0.8708, UL AUC: 0.7018, ACC AUC: 0.8648, ACC NDCG@20: 0.0461, Current time: 0.37min
[RecUL] Epoch [3/2000], Loss: 0.7855, UL AUC: 0.7125, ACC AUC: 0.8826, ACC NDCG@20: 0.0462, Current time: 0.54min
[RecUL] Epoch [4/2000], Loss: 0.7241, UL AUC: 0.7185, ACC AUC: 0.8866, ACC NDCG@20: 0.0462, Current time: 0.71min
[RecUL] Epoch [5/2000], Loss: 0.6881, UL AUC: 0.7183, ACC AUC: 0.8915, ACC NDCG@20: 0.0462, Current time: 0.88min
[RecUL] Epoch [6/2000], Loss: 0.6512, UL AUC: 0.7299, ACC AUC: 0.8964, ACC NDCG@20: 0.0462, Current time: 1.05min
[RecUL] Epoch [7/2000], Loss: 0.6222, UL AUC: 0.7497, ACC AUC: 0.8985, ACC NDCG@20: 0.0462, Current time: 1.22min
[RecUL] Epoch [8/2000], Loss: 0.6147, UL AUC: 0.7524, ACC AUC: 0.9002, ACC NDCG@20: 0.0461, Current time: 1.39min
[RecUL] Epoch [9/2000], Loss: 0.5920, UL AUC: 0.7444, ACC AUC: 0.9032, ACC NDCG@20: 0.0461, Current time: 1.56min
[RecUL] Epoch [10/2000], Loss: 0.5750, UL AUC: 0.7488, ACC AUC: 0.9029, ACC NDCG@20: 0.0461, Current time: 1.73min
[RecUL] Epoch [11/2000], Loss: 0.5630, UL AUC: 0.7491, ACC AUC: 0.9046, ACC NDCG@20: 0.0461, Current time: 1.90min
[RecUL] Epoch [12/2000], Loss: 0.5563, UL AUC: 0.7578, ACC AUC: 0.9057, ACC NDCG@20: 0.0460, Current time: 2.07min
[RecUL] Epoch [13/2000], Loss: 0.5352, UL AUC: 0.7725, ACC AUC: 0.9060, ACC NDCG@20: 0.0460, Current time: 2.25min
[RecUL] Epoch [14/2000], Loss: 0.5135, UL AUC: 0.7801, ACC AUC: 0.9082, ACC NDCG@20: 0.0460, Current time: 2.42min
[RecUL] Epoch [15/2000], Loss: 0.5066, UL AUC: 0.7794, ACC AUC: 0.9082, ACC NDCG@20: 0.0460, Current time: 2.59min
[RecUL] Epoch [16/2000], Loss: 0.5019, UL AUC: 0.7862, ACC AUC: 0.9074, ACC NDCG@20: 0.0459, Current time: 2.76min
[RecUL] Epoch [17/2000], Loss: 0.4836, UL AUC: 0.7986, ACC AUC: 0.9085, ACC NDCG@20: 0.0459, Current time: 2.93min
[RecUL] Epoch [18/2000], Loss: 0.4665, UL AUC: 0.7946, ACC AUC: 0.9080, ACC NDCG@20: 0.0459, Current time: 3.10min
[RecUL] Epoch [19/2000], Loss: 0.4651, UL AUC: 0.8018, ACC AUC: 0.9125, ACC NDCG@20: 0.0459, Current time: 3.27min
[RecUL] Epoch [20/2000], Loss: 0.4519, UL AUC: 0.8143, ACC AUC: 0.9128, ACC NDCG@20: 0.0457, Current time: 3.44min
[RecUL] Epoch [21/2000], Loss: 0.4323, UL AUC: 0.8199, ACC AUC: 0.9111, ACC NDCG@20: 0.0457, Current time: 3.61min
[RecUL] Epoch [22/2000], Loss: 0.4202, UL AUC: 0.8325, ACC AUC: 0.9116, ACC NDCG@20: 0.0457, Current time: 3.78min
[RecUL] Epoch [23/2000], Loss: 0.4066, UL AUC: 0.8251, ACC AUC: 0.9103, ACC NDCG@20: 0.0456, Current time: 3.94min
[RecUL] Epoch [24/2000], Loss: 0.4092, UL AUC: 0.8409, ACC AUC: 0.9107, ACC NDCG@20: 0.0455, Current time: 4.11min
[RecUL] Epoch [25/2000], Loss: 0.3834, UL AUC: 0.8504, ACC AUC: 0.9125, ACC NDCG@20: 0.0455, Current time: 4.28min
[RecUL] Epoch [26/2000], Loss: 0.3745, UL AUC: 0.8558, ACC AUC: 0.9093, ACC NDCG@20: 0.0455, Current time: 4.45min
[RecUL] Epoch [27/2000], Loss: 0.3713, UL AUC: 0.8586, ACC AUC: 0.9122, ACC NDCG@20: 0.0453, Current time: 4.62min
[RecUL] Epoch [28/2000], Loss: 0.3548, UL AUC: 0.8614, ACC AUC: 0.9123, ACC NDCG@20: 0.0453, Current time: 4.79min
[RecUL] Epoch [29/2000], Loss: 0.3416, UL AUC: 0.8621, ACC AUC: 0.9119, ACC NDCG@20: 0.0453, Current time: 4.96min
[RecUL] Epoch [30/2000], Loss: 0.3443, UL AUC: 0.8764, ACC AUC: 0.9112, ACC NDCG@20: 0.0453, Current time: 5.13min
[RecUL] Epoch [31/2000], Loss: 0.3354, UL AUC: 0.8732, ACC AUC: 0.9128, ACC NDCG@20: 0.0452, Current time: 5.30min
[RecUL] Epoch [32/2000], Loss: 0.3170, UL AUC: 0.8755, ACC AUC: 0.9140, ACC NDCG@20: 0.0452, Current time: 5.47min
[RecUL] Epoch [33/2000], Loss: 0.3051, UL AUC: 0.8693, ACC AUC: 0.9118, ACC NDCG@20: 0.0452, Current time: 5.64min
[RecUL] Epoch [34/2000], Loss: 0.3002, UL AUC: 0.8843, ACC AUC: 0.9122, ACC NDCG@20: 0.0452, Current time: 5.81min
[RecUL] Epoch [35/2000], Loss: 0.2914, UL AUC: 0.8877, ACC AUC: 0.9127, ACC NDCG@20: 0.0451, Current time: 5.98min
[RecUL] Epoch [36/2000], Loss: 0.3073, UL AUC: 0.8853, ACC AUC: 0.9131, ACC NDCG@20: 0.0451, Current time: 6.15min
[RecUL] Epoch [37/2000], Loss: 0.3385, UL AUC: 0.8930, ACC AUC: 0.9119, ACC NDCG@20: 0.0450, Current time: 6.32min
[RecUL] Epoch [38/2000], Loss: 0.3113, UL AUC: 0.8928, ACC AUC: 0.9131, ACC NDCG@20: 0.0449, Current time: 6.49min
[RecUL] Epoch [39/2000], Loss: 0.3112, UL AUC: 0.8851, ACC AUC: 0.9111, ACC NDCG@20: 0.0449, Current time: 6.66min
[RecUL] Epoch [40/2000], Loss: 0.2850, UL AUC: 0.8803, ACC AUC: 0.9102, ACC NDCG@20: 0.0448, Current time: 6.83min
[RecUL] Epoch [41/2000], Loss: 0.2616, UL AUC: 0.9016, ACC AUC: 0.9121, ACC NDCG@20: 0.0449, Current time: 7.00min
[RecUL] Epoch [42/2000], Loss: 0.2548, UL AUC: 0.9103, ACC AUC: 0.9125, ACC NDCG@20: 0.0448, Current time: 7.18min
[RecUL] Epoch [43/2000], Loss: 0.2637, UL AUC: 0.8940, ACC AUC: 0.9134, ACC NDCG@20: 0.0448, Current time: 7.35min
[RecUL] Epoch [44/2000], Loss: 0.2642, UL AUC: 0.9113, ACC AUC: 0.9123, ACC NDCG@20: 0.0448, Current time: 7.52min
[RecUL] Epoch [45/2000], Loss: 0.2658, UL AUC: 0.9214, ACC AUC: 0.9124, ACC NDCG@20: 0.0447, Current time: 7.69min
[RecUL] Epoch [46/2000], Loss: 0.2706, UL AUC: 0.9028, ACC AUC: 0.9124, ACC NDCG@20: 0.0446, Current time: 7.87min
[RecUL] Epoch [47/2000], Loss: 0.2848, UL AUC: 0.9138, ACC AUC: 0.9137, ACC NDCG@20: 0.0445, Current time: 8.04min
[RecUL] Epoch [48/2000], Loss: 0.2582, UL AUC: 0.9174, ACC AUC: 0.9124, ACC NDCG@20: 0.0444, Current time: 8.21min
[RecUL] Epoch [49/2000], Loss: 0.2570, UL AUC: 0.9194, ACC AUC: 0.9114, ACC NDCG@20: 0.0443, Current time: 8.38min
[RecUL] Epoch [50/2000], Loss: 0.2617, UL AUC: 0.9083, ACC AUC: 0.9141, ACC NDCG@20: 0.0444, Current time: 8.55min
[RecUL] Epoch [51/2000], Loss: 0.2638, UL AUC: 0.9147, ACC AUC: 0.9147, ACC NDCG@20: 0.0442, Current time: 8.72min
[RecUL] Epoch [52/2000], Loss: 0.2304, UL AUC: 0.9279, ACC AUC: 0.9165, ACC NDCG@20: 0.0443, Current time: 8.89min
[RecUL] Epoch [53/2000], Loss: 0.2373, UL AUC: 0.9275, ACC AUC: 0.9136, ACC NDCG@20: 0.0442, Current time: 9.05min
[RecUL] Epoch [54/2000], Loss: 0.2394, UL AUC: 0.9244, ACC AUC: 0.9155, ACC NDCG@20: 0.0443, Current time: 9.22min
[RecUL] Epoch [55/2000], Loss: 0.2266, UL AUC: 0.9219, ACC AUC: 0.9147, ACC NDCG@20: 0.0442, Current time: 9.38min
[RecUL] Epoch [56/2000], Loss: 0.2228, UL AUC: 0.9361, ACC AUC: 0.9136, ACC NDCG@20: 0.0442, Current time: 9.55min
[RecUL] Epoch [57/2000], Loss: 0.2513, UL AUC: 0.9288, ACC AUC: 0.9153, ACC NDCG@20: 0.0441, Current time: 9.72min
[RecUL] Epoch [58/2000], Loss: 0.2362, UL AUC: 0.9266, ACC AUC: 0.9142, ACC NDCG@20: 0.0441, Current time: 9.90min
[RecUL] Epoch [59/2000], Loss: 0.2308, UL AUC: 0.9280, ACC AUC: 0.9136, ACC NDCG@20: 0.0440, Current time: 10.07min
[RecUL] Epoch [60/2000], Loss: 0.2213, UL AUC: 0.9310, ACC AUC: 0.9154, ACC NDCG@20: 0.0440, Current time: 10.23min
[RecUL] Epoch [61/2000], Loss: 0.2453, UL AUC: 0.9325, ACC AUC: 0.9144, ACC NDCG@20: 0.0441, Current time: 10.40min
[RecUL] Epoch [62/2000], Loss: 0.2196, UL AUC: 0.9356, ACC AUC: 0.9154, ACC NDCG@20: 0.0440, Current time: 10.57min
[RecUL] Epoch [63/2000], Loss: 0.2120, UL AUC: 0.9330, ACC AUC: 0.9153, ACC NDCG@20: 0.0440, Current time: 10.74min
[RecUL] Epoch [64/2000], Loss: 0.2143, UL AUC: 0.9443, ACC AUC: 0.9141, ACC NDCG@20: 0.0440, Current time: 10.91min
[RecUL] Epoch [65/2000], Loss: 0.2061, UL AUC: 0.9310, ACC AUC: 0.9165, ACC NDCG@20: 0.0439, Current time: 11.08min
[RecUL] Epoch [66/2000], Loss: 0.2209, UL AUC: 0.9398, ACC AUC: 0.9168, ACC NDCG@20: 0.0439, Current time: 11.25min
Best UL AUC: 0.9361, Best epoch: 55, total time: 11.41min
[RECUL] TRAINING FINISHED. TOTAL TIME: 11.61min.
Precision@20: 0.0247; Recall@20: 0.0544;  NDCG@20: 0.0443;  
Precision@50: 0.0198; Recall@50: 0.1081;  NDCG@50: 0.0643;  
Precision@100: 0.0160; Recall@100: 0.1723;  NDCG@100: 0.0854;  
Before unlearning: ACC AUC: 0.9280, UL AUC: 0.5021, ACC NDCG@20: 0.0460
After unlearning: ACC AUC: 0.9136, UL AUC: 0.9361, ACC NDCG@20: 0.0443
