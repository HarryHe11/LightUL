Read yelp2018 dataset done! u_num: 31668, i_num: 38048
Load a pre-trained model
UL AUC before unlearning: 0.5021
ACC AUC before unlearning: 0.9280
NDCG@20 before unlearning: 0.0460
AUC before unlearning: 0.6507
NDCG@20 before unlearning: 0.0457
[RECUL] START TRAINING. CURRENT TIME: 0.27min.
[RECUL] PREPROCESS FINISHED. CURRENT TIME: 0.01min.
[RecUL] Epoch [1/2000], Loss: 1.4467, UL AUC: 0.7088, ACC AUC: 0.8447, ACC NDCG@20: 0.0460, Current time: 0.15min
[RecUL] Epoch [2/2000], Loss: 0.8708, UL AUC: 0.7018, ACC AUC: 0.8648, ACC NDCG@20: 0.0461, Current time: 0.28min
[RecUL] Epoch [3/2000], Loss: 0.7855, UL AUC: 0.7125, ACC AUC: 0.8826, ACC NDCG@20: 0.0462, Current time: 0.60min
[RecUL] Epoch [4/2000], Loss: 0.7241, UL AUC: 0.7185, ACC AUC: 0.8866, ACC NDCG@20: 0.0462, Current time: 0.90min
[RecUL] Epoch [5/2000], Loss: 0.6881, UL AUC: 0.7183, ACC AUC: 0.8915, ACC NDCG@20: 0.0462, Current time: 1.21min
[RecUL] Epoch [6/2000], Loss: 0.6512, UL AUC: 0.7299, ACC AUC: 0.8964, ACC NDCG@20: 0.0462, Current time: 1.47min
[RecUL] Epoch [7/2000], Loss: 0.6222, UL AUC: 0.7497, ACC AUC: 0.8985, ACC NDCG@20: 0.0462, Current time: 1.60min
[RecUL] Epoch [8/2000], Loss: 0.6147, UL AUC: 0.7524, ACC AUC: 0.9002, ACC NDCG@20: 0.0461, Current time: 1.72min
[RecUL] Epoch [9/2000], Loss: 0.5920, UL AUC: 0.7444, ACC AUC: 0.9032, ACC NDCG@20: 0.0461, Current time: 1.85min
[RecUL] Epoch [10/2000], Loss: 0.5750, UL AUC: 0.7487, ACC AUC: 0.9029, ACC NDCG@20: 0.0461, Current time: 2.15min
[RecUL] Epoch [11/2000], Loss: 0.5630, UL AUC: 0.7489, ACC AUC: 0.9045, ACC NDCG@20: 0.0461, Current time: 2.46min
[RecUL] Epoch [12/2000], Loss: 0.5565, UL AUC: 0.7569, ACC AUC: 0.9055, ACC NDCG@20: 0.0460, Current time: 2.76min
[RecUL] Epoch [13/2000], Loss: 0.5351, UL AUC: 0.7724, ACC AUC: 0.9060, ACC NDCG@20: 0.0460, Current time: 3.01min
[RecUL] Epoch [14/2000], Loss: 0.5139, UL AUC: 0.7798, ACC AUC: 0.9084, ACC NDCG@20: 0.0460, Current time: 3.13min
[RecUL] Epoch [15/2000], Loss: 0.5062, UL AUC: 0.7793, ACC AUC: 0.9082, ACC NDCG@20: 0.0460, Current time: 3.25min
[RecUL] Epoch [16/2000], Loss: 0.5034, UL AUC: 0.7847, ACC AUC: 0.9075, ACC NDCG@20: 0.0458, Current time: 3.46min
[RecUL] Epoch [17/2000], Loss: 0.4847, UL AUC: 0.7980, ACC AUC: 0.9085, ACC NDCG@20: 0.0459, Current time: 3.79min
[RecUL] Epoch [18/2000], Loss: 0.4671, UL AUC: 0.7946, ACC AUC: 0.9080, ACC NDCG@20: 0.0459, Current time: 4.11min
[RecUL] Epoch [19/2000], Loss: 0.4663, UL AUC: 0.8027, ACC AUC: 0.9124, ACC NDCG@20: 0.0458, Current time: 4.43min
[RecUL] Epoch [20/2000], Loss: 0.4521, UL AUC: 0.8124, ACC AUC: 0.9125, ACC NDCG@20: 0.0458, Current time: 4.56min
[RecUL] Epoch [21/2000], Loss: 0.4332, UL AUC: 0.8187, ACC AUC: 0.9110, ACC NDCG@20: 0.0457, Current time: 4.69min
[RecUL] Epoch [22/2000], Loss: 0.4207, UL AUC: 0.8299, ACC AUC: 0.9116, ACC NDCG@20: 0.0457, Current time: 4.81min
[RecUL] Epoch [23/2000], Loss: 0.4064, UL AUC: 0.8253, ACC AUC: 0.9101, ACC NDCG@20: 0.0456, Current time: 5.13min
[RecUL] Epoch [24/2000], Loss: 0.4079, UL AUC: 0.8396, ACC AUC: 0.9109, ACC NDCG@20: 0.0454, Current time: 5.45min
[RecUL] Epoch [25/2000], Loss: 0.3806, UL AUC: 0.8494, ACC AUC: 0.9124, ACC NDCG@20: 0.0455, Current time: 5.77min
[RecUL] Epoch [26/2000], Loss: 0.3750, UL AUC: 0.8548, ACC AUC: 0.9091, ACC NDCG@20: 0.0454, Current time: 5.98min
[RecUL] Epoch [27/2000], Loss: 0.3730, UL AUC: 0.8566, ACC AUC: 0.9118, ACC NDCG@20: 0.0453, Current time: 6.10min
[RecUL] Epoch [28/2000], Loss: 0.3538, UL AUC: 0.8608, ACC AUC: 0.9124, ACC NDCG@20: 0.0453, Current time: 6.23min
[RecUL] Epoch [29/2000], Loss: 0.3435, UL AUC: 0.8613, ACC AUC: 0.9119, ACC NDCG@20: 0.0453, Current time: 6.46min
[RecUL] Epoch [30/2000], Loss: 0.3460, UL AUC: 0.8753, ACC AUC: 0.9110, ACC NDCG@20: 0.0452, Current time: 6.78min
[RecUL] Epoch [31/2000], Loss: 0.3321, UL AUC: 0.8709, ACC AUC: 0.9126, ACC NDCG@20: 0.0452, Current time: 7.10min
[RecUL] Epoch [32/2000], Loss: 0.3188, UL AUC: 0.8743, ACC AUC: 0.9138, ACC NDCG@20: 0.0452, Current time: 7.42min
[RecUL] Epoch [33/2000], Loss: 0.3108, UL AUC: 0.8698, ACC AUC: 0.9117, ACC NDCG@20: 0.0452, Current time: 7.54min
[RecUL] Epoch [34/2000], Loss: 0.3038, UL AUC: 0.8840, ACC AUC: 0.9126, ACC NDCG@20: 0.0452, Current time: 7.66min
[RecUL] Epoch [35/2000], Loss: 0.2896, UL AUC: 0.8862, ACC AUC: 0.9132, ACC NDCG@20: 0.0451, Current time: 7.79min
[RecUL] Epoch [36/2000], Loss: 0.3110, UL AUC: 0.8878, ACC AUC: 0.9133, ACC NDCG@20: 0.0450, Current time: 8.09min
[RecUL] Epoch [37/2000], Loss: 0.3418, UL AUC: 0.8918, ACC AUC: 0.9123, ACC NDCG@20: 0.0450, Current time: 8.40min
[RecUL] Epoch [38/2000], Loss: 0.3125, UL AUC: 0.8915, ACC AUC: 0.9129, ACC NDCG@20: 0.0450, Current time: 8.71min
[RecUL] Epoch [39/2000], Loss: 0.3057, UL AUC: 0.8861, ACC AUC: 0.9118, ACC NDCG@20: 0.0450, Current time: 8.95min
[RecUL] Epoch [40/2000], Loss: 0.2808, UL AUC: 0.8819, ACC AUC: 0.9114, ACC NDCG@20: 0.0450, Current time: 9.07min
[RecUL] Epoch [41/2000], Loss: 0.2610, UL AUC: 0.9006, ACC AUC: 0.9122, ACC NDCG@20: 0.0449, Current time: 9.20min
[RecUL] Epoch [42/2000], Loss: 0.2552, UL AUC: 0.9128, ACC AUC: 0.9129, ACC NDCG@20: 0.0449, Current time: 9.39min
[RecUL] Epoch [43/2000], Loss: 0.2652, UL AUC: 0.8934, ACC AUC: 0.9132, ACC NDCG@20: 0.0449, Current time: 9.71min
[RecUL] Epoch [44/2000], Loss: 0.2665, UL AUC: 0.9122, ACC AUC: 0.9123, ACC NDCG@20: 0.0447, Current time: 10.02min
[RecUL] Epoch [45/2000], Loss: 0.2674, UL AUC: 0.9193, ACC AUC: 0.9116, ACC NDCG@20: 0.0447, Current time: 10.34min
[RecUL] Epoch [46/2000], Loss: 0.2756, UL AUC: 0.9010, ACC AUC: 0.9123, ACC NDCG@20: 0.0446, Current time: 10.48min
[RecUL] Epoch [47/2000], Loss: 0.2832, UL AUC: 0.9106, ACC AUC: 0.9146, ACC NDCG@20: 0.0446, Current time: 10.60min
[RecUL] Epoch [48/2000], Loss: 0.2557, UL AUC: 0.9174, ACC AUC: 0.9126, ACC NDCG@20: 0.0445, Current time: 10.73min
[RecUL] Epoch [49/2000], Loss: 0.2590, UL AUC: 0.9201, ACC AUC: 0.9108, ACC NDCG@20: 0.0446, Current time: 11.06min
[RecUL] Epoch [50/2000], Loss: 0.2590, UL AUC: 0.9060, ACC AUC: 0.9136, ACC NDCG@20: 0.0445, Current time: 11.38min
[RecUL] Epoch [51/2000], Loss: 0.2633, UL AUC: 0.9145, ACC AUC: 0.9149, ACC NDCG@20: 0.0445, Current time: 11.70min
[RecUL] Epoch [52/2000], Loss: 0.2319, UL AUC: 0.9274, ACC AUC: 0.9163, ACC NDCG@20: 0.0445, Current time: 11.92min
[RecUL] Epoch [53/2000], Loss: 0.2357, UL AUC: 0.9321, ACC AUC: 0.9130, ACC NDCG@20: 0.0445, Current time: 12.04min
[RecUL] Epoch [54/2000], Loss: 0.2416, UL AUC: 0.9268, ACC AUC: 0.9155, ACC NDCG@20: 0.0444, Current time: 12.17min
[RecUL] Epoch [55/2000], Loss: 0.2278, UL AUC: 0.9230, ACC AUC: 0.9148, ACC NDCG@20: 0.0443, Current time: 12.41min
[RecUL] Epoch [56/2000], Loss: 0.2240, UL AUC: 0.9355, ACC AUC: 0.9136, ACC NDCG@20: 0.0443, Current time: 12.72min
[RecUL] Epoch [57/2000], Loss: 0.2490, UL AUC: 0.9273, ACC AUC: 0.9153, ACC NDCG@20: 0.0442, Current time: 13.03min
[RecUL] Epoch [58/2000], Loss: 0.2317, UL AUC: 0.9290, ACC AUC: 0.9149, ACC NDCG@20: 0.0442, Current time: 13.35min
[RecUL] Epoch [59/2000], Loss: 0.2298, UL AUC: 0.9297, ACC AUC: 0.9134, ACC NDCG@20: 0.0440, Current time: 13.47min
[RecUL] Epoch [60/2000], Loss: 0.2250, UL AUC: 0.9327, ACC AUC: 0.9146, ACC NDCG@20: 0.0440, Current time: 13.60min
[RecUL] Epoch [61/2000], Loss: 0.2341, UL AUC: 0.9394, ACC AUC: 0.9141, ACC NDCG@20: 0.0440, Current time: 13.77min
[RecUL] Epoch [62/2000], Loss: 0.2177, UL AUC: 0.9387, ACC AUC: 0.9151, ACC NDCG@20: 0.0440, Current time: 14.08min
[RecUL] Epoch [63/2000], Loss: 0.2116, UL AUC: 0.9348, ACC AUC: 0.9154, ACC NDCG@20: 0.0439, Current time: 14.39min
[RecUL] Epoch [64/2000], Loss: 0.2105, UL AUC: 0.9440, ACC AUC: 0.9148, ACC NDCG@20: 0.0439, Current time: 14.73min
[RecUL] Epoch [65/2000], Loss: 0.2058, UL AUC: 0.9291, ACC AUC: 0.9166, ACC NDCG@20: 0.0438, Current time: 14.89min
[RecUL] Epoch [66/2000], Loss: 0.2222, UL AUC: 0.9419, ACC AUC: 0.9169, ACC NDCG@20: 0.0438, Current time: 15.01min
[RecUL] Epoch [67/2000], Loss: 0.2200, UL AUC: 0.9402, ACC AUC: 0.9113, ACC NDCG@20: 0.0438, Current time: 15.13min
[RecUL] Epoch [68/2000], Loss: 0.2056, UL AUC: 0.9387, ACC AUC: 0.9165, ACC NDCG@20: 0.0438, Current time: 15.45min
[RecUL] Epoch [69/2000], Loss: 0.2128, UL AUC: 0.9455, ACC AUC: 0.9149, ACC NDCG@20: 0.0437, Current time: 15.78min
[RecUL] Epoch [70/2000], Loss: 0.2047, UL AUC: 0.9392, ACC AUC: 0.9149, ACC NDCG@20: 0.0437, Current time: 16.11min
[RecUL] Epoch [71/2000], Loss: 0.2157, UL AUC: 0.9538, ACC AUC: 0.9120, ACC NDCG@20: 0.0437, Current time: 16.32min
[RecUL] Epoch [72/2000], Loss: 0.1948, UL AUC: 0.9454, ACC AUC: 0.9149, ACC NDCG@20: 0.0437, Current time: 16.44min
[RecUL] Epoch [73/2000], Loss: 0.1849, UL AUC: 0.9433, ACC AUC: 0.9154, ACC NDCG@20: 0.0437, Current time: 16.57min
[RecUL] Epoch [74/2000], Loss: 0.2052, UL AUC: 0.9481, ACC AUC: 0.9152, ACC NDCG@20: 0.0436, Current time: 16.82min
[RecUL] Epoch [75/2000], Loss: 0.1943, UL AUC: 0.9412, ACC AUC: 0.9154, ACC NDCG@20: 0.0436, Current time: 17.15min
[RecUL] Epoch [76/2000], Loss: 0.2088, UL AUC: 0.9459, ACC AUC: 0.9129, ACC NDCG@20: 0.0436, Current time: 17.48min
[RecUL] Epoch [77/2000], Loss: 0.2018, UL AUC: 0.9416, ACC AUC: 0.9160, ACC NDCG@20: 0.0436, Current time: 17.76min
[RecUL] Epoch [78/2000], Loss: 0.1905, UL AUC: 0.9415, ACC AUC: 0.9157, ACC NDCG@20: 0.0436, Current time: 17.89min
[RecUL] Epoch [79/2000], Loss: 0.2130, UL AUC: 0.9427, ACC AUC: 0.9157, ACC NDCG@20: 0.0436, Current time: 18.02min
[RecUL] Epoch [80/2000], Loss: 0.1941, UL AUC: 0.9478, ACC AUC: 0.9138, ACC NDCG@20: 0.0436, Current time: 18.14min
[RecUL] Epoch [81/2000], Loss: 0.2062, UL AUC: 0.9493, ACC AUC: 0.9158, ACC NDCG@20: 0.0436, Current time: 18.47min
Best UL AUC: 0.9538, Best epoch: 70, total time: 18.80min
[RECUL] TRAINING FINISHED. TOTAL TIME: 19.07min.
Precision@20: 0.0244; Recall@20: 0.0540;  NDCG@20: 0.0437;  
Precision@50: 0.0196; Recall@50: 0.1069;  NDCG@50: 0.0636;  
Precision@100: 0.0159; Recall@100: 0.1713;  NDCG@100: 0.0846;  
Before unlearning: ACC AUC: 0.9280, UL AUC: 0.5021, ACC NDCG@20: 0.0460
After unlearning: ACC AUC: 0.9120, UL AUC: 0.9538, ACC NDCG@20: 0.0437
